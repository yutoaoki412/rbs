<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯å‹•çš„ã«è¨­å®šã•ã‚Œã¾ã™ -->
  <title>ãƒ‹ãƒ¥ãƒ¼ã‚¹è©³ç´° - RBSé™¸ä¸Šæ•™å®¤</title>
  <meta name="description" content="RBSé™¸ä¸Šæ•™å®¤ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹è©³ç´°ãƒšãƒ¼ã‚¸">
  <meta name="keywords" content="RBS,é™¸ä¸Šæ•™å®¤,Running,Brain,School,å­ã©ã‚‚,ã‚¹ãƒãƒ¼ãƒ„,ãƒ‹ãƒ¥ãƒ¼ã‚¹">
  <meta name="robots" content="index, follow">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="./assets/images/rds-logo.png">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700;800;900&family=Nunito+Sans:wght@300;400;500;600;700;800;900&family=Noto+Sans+JP:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="./css/header.css">
  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/common.css">
  <link rel="stylesheet" href="./css/components.css">
  <link rel="stylesheet" href="./css/layout.css">
  <link rel="stylesheet" href="./css/news.css">
  <link rel="stylesheet" href="./css/news-detail.css">
  <link rel="stylesheet" href="./css/responsive.css">
</head>
<body class="page-news-detail">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ -->
  <div id="header-container"></div>

  <main class="news-detail-content">
    <!-- ãƒ‘ãƒ³ããšãƒŠãƒ“ -->
    <section class="breadcrumb-section">
      <div class="container">
        <nav class="breadcrumb card-base">
          <ul class="breadcrumb-list">
            <li><a href="./index.html">ãƒ›ãƒ¼ãƒ </a></li>
            <li><span class="breadcrumb-separator">&gt;</span></li>
            <li><a href="news.html">ãƒ‹ãƒ¥ãƒ¼ã‚¹</a></li>
            <li><span class="breadcrumb-separator">&gt;</span></li>
            <li><span id="breadcrumb-title">è¨˜äº‹è©³ç´°</span></li>
          </ul>
        </nav>
      </div>
    </section>

    <!-- è¨˜äº‹ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ«éƒ¨åˆ†ï¼‰ -->
    <section class="article-header-section">
      <div class="container">
        <div class="article-header-card card-base">
          <div class="article-meta">
            <span class="news-date" id="article-date">
              <i class="fas fa-calendar"></i> èª­ã¿è¾¼ã¿ä¸­...
            </span>
            <span class="news-category" id="article-category">èª­ã¿è¾¼ã¿ä¸­...</span>
          </div>
          <h1 class="article-title" id="article-title">è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</h1>
        </div>
      </div>
    </section>

    <!-- è¨˜äº‹æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section id="article-summary-section" class="article-summary-section hidden">
      <div class="container">
        <div class="article-summary-card card-base">
          <div class="summary-header">
            <h2 class="summary-title">
              <i class="fas fa-info-circle"></i>
              è¨˜äº‹ã®æ¦‚è¦
            </h2>
          </div>
          <div class="summary-content" id="article-summary">
            <!-- æ¦‚è¦ã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
          </div>
        </div>
      </div>
    </section>

    <!-- è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <section class="article-content-section">
      <div class="container">
        <div class="article-content-card card-base">
          <div class="article-content" id="article-content">
            <div class="loading-message">
              <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
              </div>
              <h3>è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</h3>
              <p>ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ã‚·ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section id="share-section" class="share-section hidden">
      <div class="container">
        <div class="share-container card-base">
          <h3 class="section-title">ã“ã®è¨˜äº‹ã‚’ã‚·ã‚§ã‚¢</h3>
          <div class="share-buttons">
            <button data-action="share-twitter" class="share-btn twitter">
              <img src="./assets/images/sns/x.png" alt="X (Twitter)" width="20" height="20">
              <span>X ã§ã‚·ã‚§ã‚¢</span>
            </button>
            <button data-action="share-facebook" class="share-btn facebook">
              <img src="./assets/images/sns/facebook.png" alt="Facebook" width="20" height="20">
              <span>Facebook ã§ã‚·ã‚§ã‚¢</span>
            </button>
            <button data-action="share-line" class="share-btn line">
              <img src="./assets/images/sns/line.png" alt="LINE" width="20" height="20">
              <span>LINE ã§é€ã‚‹</span>
            </button>
            <button data-action="copy-url" class="share-btn copy">
              <i class="fas fa-link"></i>
              <span>URL ã‚’ã‚³ãƒ”ãƒ¼</span>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- é–¢é€£è¨˜äº‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section id="related-articles" class="related-articles-section hidden">
      <div class="container">
        <div class="related-articles-container">
          <h2 class="section-title">é–¢é€£è¨˜äº‹</h2>
          <div class="news-grid" id="related-articles-container">
            <!-- é–¢é€£è¨˜äº‹ã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
          </div>
        </div>
      </div>
    </section>

    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <section class="article-navigation-section">
      <div class="container">
        <div class="article-nav">
          <a href="news.html" class="btn-primary nav-btn">
            <i class="fas fa-arrow-left"></i>
            ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹
          </a>
        </div>
      </div>
    </section>
  </main>

  <!-- ãƒ•ãƒƒã‚¿ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ -->
  <div id="footer-container"></div>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆES6ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ -->
  <script type="module" src="./js/app/main.js?v=1.0.3"></script>
  
  <!-- GitHub Pageså¯¾å¿œ: éãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç‰ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ -->
  <script>
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ããƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿
    window.RBSNewsDetail = {
      errors: [],
      initialized: false,
      
      logError: function(error, context) {
        console.error(`[RBS News Detail Error - ${context}]:`, error);
        this.errors.push({ error, context, timestamp: new Date() });
      }
    };
    
    // ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å‡¦ç†é–¢æ•°ï¼ˆNewsUtils.formatContentã®ç°¡æ˜“ç‰ˆï¼‰
    function formatMarkdownContent(content) {
      if (!content) return '<p>è¨˜äº‹ã®å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
      
      // æ”¹è¡Œã‚’çµ±ä¸€ï¼ˆ\r\nã‚„\rã‚’\nã«å¤‰æ›ï¼‰
      let formattedContent = content.replace(/\r\n|\r/g, '\n');
      
      // ãƒ˜ãƒƒãƒ€ãƒ¼ã®å‡¦ç†ï¼ˆæ®µéšçš„ã«å‡¦ç† - h6ã‹ã‚‰h1ã®é †ã§å‡¦ç†ï¼‰
      formattedContent = formattedContent
        .replace(/^###### (.*$)/gm, '<h6>$1</h6>')
        .replace(/^##### (.*$)/gm, '<h5>$1</h5>')
        .replace(/^#### (.*$)/gm, '<h4>$1</h4>')
        .replace(/^### (.*$)/gm, '<h3>$1</h3>')
        .replace(/^## (.*$)/gm, '<h2>$1</h2>')
        .replace(/^# (.*$)/gm, '<h1>$1</h1>');
      
      // å¤ªå­—ãƒ»ã‚¤ã‚¿ãƒªãƒƒã‚¯ã®å‡¦ç†
      formattedContent = formattedContent
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>');
      
      // ãƒªãƒ³ã‚¯ã®å‡¦ç†
      formattedContent = formattedContent
        .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');
      
      // æ°´å¹³ç·šã®å‡¦ç†
      formattedContent = formattedContent
        .replace(/^---$/gm, '<hr>')
        .replace(/^\*\*\*$/gm, '<hr>')
        .replace(/^___$/gm, '<hr>');
      
      // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®å‡¦ç†
      formattedContent = formattedContent
        .replace(/```([^`]*?)```/g, '<pre><code>$1</code></pre>')
        .replace(/`([^`]+)`/g, '<code>$1</code>');
      
      // è¡Œã”ã¨ã«å‡¦ç†ã—ã¦ãƒªã‚¹ãƒˆã¨æ®µè½ã‚’é©åˆ‡ã«ç”Ÿæˆ
      const lines = formattedContent.split('\n');
      const processedLines = [];
      let inList = false;
      let listType = null; // 'ul' or 'ol'
      let inBlockquote = false;
      
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        
        // ç©ºè¡Œã®å‡¦ç†
        if (!line) {
          if (inList) {
            processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
            inList = false;
            listType = null;
          }
          if (inBlockquote) {
            processedLines.push('</blockquote>');
            inBlockquote = false;
          }
          processedLines.push(''); // ç©ºè¡Œã‚’ä¿æŒ
          continue;
        }
        
        // å¼•ç”¨ã®å‡¦ç†
        const blockquoteMatch = line.match(/^>\s+(.*)$/);
        if (blockquoteMatch) {
          if (inList) {
            processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
            inList = false;
            listType = null;
          }
          if (!inBlockquote) {
            processedLines.push('<blockquote>');
            inBlockquote = true;
          }
          processedLines.push(`<p>${blockquoteMatch[1]}</p>`);
          continue;
        } else if (inBlockquote) {
          processedLines.push('</blockquote>');
          inBlockquote = false;
        }
        
        // ãƒ˜ãƒƒãƒ€ãƒ¼ã¾ãŸã¯æ°´å¹³ç·šã®å ´åˆã¯ãã®ã¾ã¾è¿½åŠ 
        if (line.match(/^<(h[1-6]|hr)>/)) {
          if (inList) {
            processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
            inList = false;
            listType = null;
          }
          processedLines.push(line);
          continue;
        }
        
        // ãƒªã‚¹ãƒˆé …ç›®ã®å‡¦ç†
        const unorderedListMatch = line.match(/^[-*+]\s+(.*)$/);
        const orderedListMatch = line.match(/^(\d+)\.\s+(.*)$/);
        
        if (unorderedListMatch || orderedListMatch) {
          const isUnordered = !!unorderedListMatch;
          const currentListType = isUnordered ? 'ul' : 'ol';
          const listContent = isUnordered ? unorderedListMatch[1] : orderedListMatch[2];
          
          // ãƒªã‚¹ãƒˆã‚¿ã‚¤ãƒ—ãŒå¤‰ã‚ã£ãŸå ´åˆã€å‰ã®ãƒªã‚¹ãƒˆã‚’é–‰ã˜ã‚‹
          if (inList && listType !== currentListType) {
            processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
            inList = false;
          }
          
          // æ–°ã—ã„ãƒªã‚¹ãƒˆã‚’é–‹å§‹
          if (!inList) {
            processedLines.push(currentListType === 'ul' ? '<ul>' : '<ol>');
            inList = true;
            listType = currentListType;
          }
          
          processedLines.push(`<li>${listContent}</li>`);
        } else {
          // é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆ
          if (inList) {
            processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
            inList = false;
            listType = null;
          }
          
          // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã§ãªã‘ã‚Œã°æ®µè½ã§å›²ã‚€
          if (!line.match(/^<(pre|h[1-6]|ul|ol|li|blockquote|hr)/)) {
            processedLines.push(`<p>${line}</p>`);
          } else {
            processedLines.push(line);
          }
        }
      }
      
      // æœ€å¾Œã®ãƒªã‚¹ãƒˆã‚’é–‰ã˜ã‚‹
      if (inList) {
        processedLines.push(listType === 'ul' ? '</ul>' : '</ol>');
      }
      
      // æœ€å¾Œã®å¼•ç”¨ã‚’é–‰ã˜ã‚‹
      if (inBlockquote) {
        processedLines.push('</blockquote>');
      }
      
      // é€£ç¶šã™ã‚‹ç©ºã®æ®µè½ã‚’å‰Šé™¤ã—ã€çµæœã‚’çµåˆ
      return processedLines
        .filter((line, index, array) => {
          // ç©ºè¡Œã¨ç©ºæ®µè½ã®é€£ç¶šã‚’é¿ã‘ã‚‹
          if (line === '' || line === '<p></p>') {
            const prevLine = array[index - 1];
            const nextLine = array[index + 1];
            // å‰å¾ŒãŒæ®µè½ã‚¿ã‚°ã§ãªã„å ´åˆã®ã¿ç©ºè¡Œã‚’ä¿æŒ
            return !(prevLine && prevLine.match(/<\/(p|h[1-6]|ul|ol)>/)) && 
                   !(nextLine && nextLine.match(/^<(p|h[1-6]|ul|ol)/));
          }
          return true;
        })
        .join('\n')
        .replace(/\n{3,}/g, '\n\n') // 3å€‹ä»¥ä¸Šã®é€£ç¶šæ”¹è¡Œã‚’2å€‹ã«åˆ¶é™
        .trim();
    }
    
    // æ¦‚è¦ç”Ÿæˆé–¢æ•°
    function generateSummary(content, maxLength = 200) {
      if (!content) return '';
      
      // HTMLã‚¿ã‚°ã¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³è¨˜æ³•ã‚’é™¤å»
      let textContent = content
        .replace(/<[^>]*>/g, '') // HTMLã‚¿ã‚°ã‚’é™¤å»
        .replace(/#{1,6}\s+/g, '') // ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é™¤å»
        .replace(/\*\*(.*?)\*\*/g, '$1') // å¤ªå­—ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’é™¤å»
        .replace(/\*(.*?)\*/g, '$1') // ã‚¤ã‚¿ãƒªãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’é™¤å»
        .replace(/\[([^\]]+)\]\([^)]+\)/g, '$1') // ãƒªãƒ³ã‚¯ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’é™¤å»
        .replace(/```[\s\S]*?```/g, '') // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’é™¤å»
        .replace(/`([^`]+)`/g, '$1') // ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’é™¤å»
        .replace(/^\s*[-*+]\s+/gm, '') // ãƒªã‚¹ãƒˆè¨˜å·ã‚’é™¤å»
        .replace(/^\s*\d+\.\s+/gm, '') // æ•°å­—ãƒªã‚¹ãƒˆè¨˜å·ã‚’é™¤å»
        .replace(/^\s*>\s+/gm, '') // å¼•ç”¨è¨˜å·ã‚’é™¤å»
        .replace(/^---$|^\*\*\*$|^___$/gm, '') // æ°´å¹³ç·šã‚’é™¤å»
        .replace(/\n\s*\n/g, ' ') // æ”¹è¡Œã‚’ç©ºç™½ã«å¤‰æ›
        .replace(/\s+/g, ' ') // è¤‡æ•°ã®ç©ºç™½ã‚’1ã¤ã«
        .trim();
      
      if (textContent.length <= maxLength) return textContent;
      
      // å˜èªå¢ƒç•Œã§åˆ‡ã‚Šè©°ã‚ï¼ˆæ—¥æœ¬èªå¯¾å¿œï¼‰
      const truncated = textContent.substring(0, maxLength);
      
      // æœ€å¾Œã®å¥èª­ç‚¹ã‚„ç©ºç™½ã§åŒºåˆ‡ã‚‹
      const lastPunctuation = Math.max(
        truncated.lastIndexOf('ã€‚'),
        truncated.lastIndexOf('ã€'),
        truncated.lastIndexOf('ï¼'),
        truncated.lastIndexOf('ï¼Ÿ'),
        truncated.lastIndexOf(' ')
      );
      
      if (lastPunctuation > maxLength * 0.7) {
        return truncated.substring(0, lastPunctuation + 1);
      }
      
      return truncated + '...';
    }
    
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    let moduleLoadTimeout = setTimeout(() => {
      console.warn('[GitHub Pages] ES Modulesèª­ã¿è¾¼ã¿ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚');
      
      // åŸºæœ¬çš„ãªè¨˜äº‹è¡¨ç¤ºå‡¦ç†ï¼ˆéãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç‰ˆï¼‰
      const articleTitle = document.getElementById('article-title');
      const articleContent = document.getElementById('article-content');
      const articleDate = document.getElementById('article-date');
      const articleCategory = document.getElementById('article-category');
      const articleSummary = document.getElementById('article-summary');
      const summarySection = document.getElementById('article-summary-section');
      
      if (articleTitle && articleContent) {
        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰è¨˜äº‹IDã‚’å–å¾—
        const urlParams = new URLSearchParams(window.location.search);
        const articleId = urlParams.get('id');
        
        if (articleId) {
          try {
            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
            const articlesData = localStorage.getItem('rbs_articles');
            const articles = articlesData ? JSON.parse(articlesData) : [];
            
            // è¨˜äº‹ã‚’æ¤œç´¢
            const article = articles.find(a => a.id === articleId);
            
            if (article) {
              // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°
              document.title = `${article.title} - RBSé™¸ä¸Šæ•™å®¤`;
              
              // è¨˜äº‹è¡¨ç¤º
              const categoryInfo = getCategoryInfo(article.category);
              const formattedDate = formatDate(article.publishedAt || article.createdAt);
              
              articleTitle.textContent = article.title;
              articleDate.innerHTML = `<i class="fas fa-calendar"></i> ${formattedDate}`;
              articleCategory.textContent = categoryInfo.label;
              articleCategory.className = `news-category ${article.category}`;
              
              // è¨˜äº‹å†…å®¹ã‚’ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å‡¦ç†
              const content = formatMarkdownContent(article.content || '<p>è¨˜äº‹ã®å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>');
              articleContent.innerHTML = content;
              
              // æ¦‚è¦è¡¨ç¤º
              if (article.summary || article.content) {
                const summaryText = article.summary || generateSummary(article.content);
                if (summaryText && summaryText.trim() !== '') {
                  articleSummary.innerHTML = `<p>${summaryText}</p>`;
                  summarySection.classList.remove('hidden');
                }
              }
              
              // ãƒ‘ãƒ³ããšæ›´æ–°
              const breadcrumbTitle = document.getElementById('breadcrumb-title');
              if (breadcrumbTitle) {
                breadcrumbTitle.textContent = article.title;
              }
              
              // ã‚·ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
              const shareSection = document.getElementById('share-section');
              if (shareSection) {
                shareSection.classList.remove('hidden');
              }
              
              // é–¢é€£è¨˜äº‹ã®è¡¨ç¤º
              showRelatedArticles(articles, article);
              
            } else {
              // è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
              showArticleNotFound();
            }
            
          } catch (error) {
            console.error('[Fallback] è¨˜äº‹èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            showLoadError();
          }
        } else {
          // è¨˜äº‹IDãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆ
          showInvalidId();
        }
      }
    }, 2000);
    
    // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    function getCategoryInfo(categoryId) {
      const categories = {
        'announcement': { label: 'ãŠçŸ¥ã‚‰ã›', color: '#4a90e2' },
        'event': { label: 'ä½“é¨“ä¼š', color: '#50c8a3' },
        'media': { label: 'ãƒ¡ãƒ‡ã‚£ã‚¢', color: '#f5a623' },
        'important': { label: 'é‡è¦', color: '#e74c3c' }
      };
      return categories[categoryId] || { label: 'ãã®ä»–', color: '#6c757d' };
    }
    
    function formatDate(dateString) {
      const date = new Date(dateString);
      return `${date.getFullYear()}/${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getDate()).padStart(2, '0')}`;
    }
    
    function showRelatedArticles(allArticles, currentArticle) {
      const relatedSection = document.getElementById('related-articles');
      const relatedContainer = document.getElementById('related-articles-container');
      
      if (!relatedSection || !relatedContainer) return;
      
      // é–¢é€£è¨˜äº‹ã‚’æ¤œç´¢ï¼ˆåŒã˜ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§ç•°ãªã‚‹è¨˜äº‹ï¼‰
      const relatedArticles = allArticles
        .filter(article => 
          article.id !== currentArticle.id && 
          article.category === currentArticle.category &&
          article.status === 'published'
        )
        .slice(0, 3);
        
      if (relatedArticles.length > 0) {
        const relatedHTML = relatedArticles.map(article => {
          const categoryInfo = getCategoryInfo(article.category);
          const formattedDate = formatDate(article.publishedAt || article.createdAt);
          
          return `
            <article class="news-card related-card">
              <div class="news-card-header">
                <div class="news-meta">
                  <div class="news-date">${formattedDate}</div>
                  <div class="related-category ${article.category}">${categoryInfo.label}</div>
                </div>
                <h3 class="news-title">
                  <a href="news-detail.html?id=${article.id}">${article.title}</a>
                </h3>
              </div>
              <div class="news-card-body">
                <p class="news-excerpt">${(article.summary || generateSummary(article.content)) + '...'}</p>
                <div class="news-actions">
                  <a href="news-detail.html?id=${article.id}" class="news-read-more">ç¶šãã‚’èª­ã‚€</a>
                </div>
              </div>
            </article>
          `;
        }).join('');
        
        relatedContainer.innerHTML = relatedHTML;
        relatedSection.classList.remove('hidden');
      }
    }
    
    function showArticleNotFound() {
      const articleContent = document.getElementById('article-content');
      articleContent.innerHTML = `
        <div class="error-message">
          <div class="error-icon">ğŸ”</div>
          <h3>è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h3>
          <p>æŒ‡å®šã•ã‚ŒãŸè¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
          <div class="error-actions">
            <a href="news.html" class="btn-primary">ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹</a>
            <a href="./index.html" class="btn-outline">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
          </div>
        </div>
      `;
      
      const articleTitle = document.getElementById('article-title');
      const articleDate = document.getElementById('article-date');
      const articleCategory = document.getElementById('article-category');
      
      articleTitle.textContent = 'è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
      articleDate.innerHTML = '<i class="fas fa-calendar"></i> -';
      articleCategory.textContent = '-';
    }
    
    function showLoadError() {
      const articleContent = document.getElementById('article-content');
      articleContent.innerHTML = `
        <div class="error-message">
          <div class="error-icon">âŒ</div>
          <h3>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h3>
          <p>è¨˜äº‹ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</p>
          <div class="error-actions">
            <button onclick="location.reload()" class="btn-primary">å†èª­ã¿è¾¼ã¿</button>
            <a href="news.html" class="btn-outline">ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹</a>
          </div>
        </div>
      `;
    }
    
    function showInvalidId() {
      const articleContent = document.getElementById('article-content');
      articleContent.innerHTML = `
        <div class="error-message">
          <div class="error-icon">ğŸ”—</div>
          <h3>ç„¡åŠ¹ãªãƒªãƒ³ã‚¯ã§ã™</h3>
          <p>è¨˜äº‹IDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
          <div class="error-actions">
            <a href="news.html" class="btn-primary">ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹</a>
            <a href="./index.html" class="btn-outline">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
          </div>
        </div>
      `;
    }
    
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚ŒãŸå ´åˆã¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ã‚¯ãƒªã‚¢
    window.addEventListener('RBSAppLoaded', function() {
      clearTimeout(moduleLoadTimeout);
      console.log('[GitHub Pages] ES Modulesæ­£å¸¸èª­ã¿è¾¼ã¿å®Œäº†');
    });
  </script>
  
  <!-- ã‚·ã‚§ã‚¢æ©Ÿèƒ½ -->
  <script>
    document.addEventListener('click', function(e) {
      const shareBtn = e.target.closest('[data-action^="share"]');
      if (!shareBtn) return;
      
      e.preventDefault();
      
      const action = shareBtn.dataset.action;
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(document.title);
      
      switch (action) {
        case 'share-twitter':
          window.open(`https://twitter.com/intent/tweet?url=${url}&text=${title}`, '_blank');
          break;
        case 'share-facebook':
          window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
          break;
        case 'share-line':
          window.open(`https://social-plugins.line.me/lineit/share?url=${url}`, '_blank');
          break;
        case 'copy-url':
          navigator.clipboard.writeText(window.location.href).then(() => {
            const originalText = shareBtn.querySelector('span').textContent;
            shareBtn.querySelector('span').textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
            setTimeout(() => {
              shareBtn.querySelector('span').textContent = originalText;
            }, 2000);
          });
          break;
      }
    });
  </script>
</body>
</html> 