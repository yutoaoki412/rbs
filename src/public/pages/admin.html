<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç®¡ç†ç”»é¢ - RBSé™¸ä¸Šæ•™å®¤</title>
  <meta name="description" content="RBSé™¸ä¸Šæ•™å®¤ã®ç®¡ç†ç”»é¢">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- CSS -->
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/components.css">
  <link rel="stylesheet" href="../css/admin.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="../assets/images/lp-logo.png">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="page-admin">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="admin-header">
    <div class="header-left">
      <i class="fas fa-running admin-logo-icon"></i>
      <span class="admin-logo-text">RBSé™¸ä¸Šæ•™å®¤ ç®¡ç†ç”»é¢</span>
    </div>
    <div class="header-right">
      <div class="notification-settings">
        <button class="notification-toggle-btn" id="notification-toggle" 
                title="é€šçŸ¥è¨­å®šã‚’åˆ‡ã‚Šæ›¿ãˆ" 
                data-action="toggle-notification-mode">
          <i class="fas fa-bell-slash"></i>
          <span class="toggle-text">é€šçŸ¥OFF</span>
        </button>
      </div>
      <div class="session-info" id="session-info">
        <i class="fas fa-clock"></i>
        <span id="session-remaining">åˆæœŸåŒ–ä¸­...</span>
      </div>
      <button class="logout-btn" data-action="logout" title="ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ">
        <i class="fas fa-sign-out-alt"></i>
        ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
      </button>
    </div>
  </header>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div class="admin-container">
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <aside class="admin-sidebar">
      <nav class="sidebar-nav">
        <div class="nav-item active" data-tab="dashboard" data-action="switch-tab">
          <i class="fas fa-chart-bar"></i>
          <span>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
        </div>
        <div class="nav-item" data-tab="news-management" data-action="switch-tab">
          <i class="fas fa-newspaper"></i>
          <span>è¨˜äº‹ç®¡ç†</span>
        </div>
        <div class="nav-item" data-tab="lesson-status" data-action="switch-tab">
          <i class="fas fa-calendar-check"></i>
          <span>ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³</span>
        </div>
        <div class="nav-item" data-tab="settings" data-action="switch-tab">
          <i class="fas fa-cog"></i>
          <span>è¨­å®š</span>
        </div>
      </nav>
    </aside>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
    <main class="admin-main">
      <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
      <section id="dashboard" class="admin-section active">
        <div class="section-header">
          <h1><i class="fas fa-chart-bar"></i> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        </div>
        
        <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-newspaper"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="total-articles">0</div>
              <div class="stat-label">ç·è¨˜äº‹æ•°</div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon published">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="published-articles">0</div>
              <div class="stat-label">å…¬é–‹æ¸ˆã¿</div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon draft">
              <i class="fas fa-edit"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="draft-articles">0</div>
              <div class="stat-label">ä¸‹æ›¸ã</div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon current-month">
              <i class="fas fa-calendar"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="current-month-articles">0</div>
              <div class="stat-label">ä»Šæœˆã®è¨˜äº‹</div>
            </div>
          </div>
        </div>

        <!-- æœ€è¿‘ã®è¨˜äº‹ -->
        <div class="dashboard-widgets">
          <div class="widget">
            <div class="widget-header">
              <h2><i class="fas fa-newspaper"></i> æœ€è¿‘ã®è¨˜äº‹</h2>
              <div class="widget-header-actions">
                <button class="btn-icon" data-action="refresh-recent-articles" title="æ›´æ–°">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            <div class="widget-content">
              <div id="recent-articles">
                <div class="loading-state">
                  <i class="fas fa-spinner fa-spin"></i>
                  è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...
                </div>
              </div>
            </div>
          </div>

          <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
          <div class="widget quick-actions">
            <div class="widget-header">
              <h2><i class="fas fa-bolt"></i> ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
            </div>
            <div class="widget-content">
              <div class="action-buttons">
                <button class="action-btn primary" data-action="new-news-article">
                  <i class="fas fa-plus"></i>
                  æ–°ã—ã„è¨˜äº‹ã‚’ä½œæˆ
                </button>
                <button class="action-btn success" data-action="switch-tab" data-tab="lesson-status">
                  <i class="fas fa-calendar-check"></i>
                  ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ã‚’æ›´æ–°
                </button>
                <button class="action-btn secondary" data-action="open-external" data-url="index.html">
                  <i class="fas fa-external-link-alt"></i>
                  ã‚µã‚¤ãƒˆã‚’ç¢ºèª
                </button>
                <button class="action-btn info" data-action="open-external" data-url="news.html">
                  <i class="fas fa-newspaper"></i>
                  ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã‚’ç¢ºèª
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- è¨˜äº‹ç®¡ç† -->
      <section id="news-management" class="admin-section">
        <div class="section-header">
          <h1><i class="fas fa-newspaper"></i> è¨˜äº‹ç®¡ç†</h1>
        </div>
        
        <!-- è¨˜äº‹ç®¡ç†ç”¨ã®ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-news-tab" data-tab="editor">
            <i class="fas fa-edit"></i>
            æ–°è¦è¨˜äº‹ä½œæˆ
          </div>
          <div class="sub-nav-item" data-action="switch-news-tab" data-tab="list">
            <i class="fas fa-list"></i>
            è¨˜äº‹ä¸€è¦§
          </div>
        </div>
        
        <!-- ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚¿ãƒ– -->
        <div id="news-editor-tab" class="news-tab-content active">
          <div class="editor-panel">
            <div class="panel-header">
              <h2><i class="fas fa-edit"></i> <span id="editor-title">æ–°è¦è¨˜äº‹ä½œæˆ</span></h2>
              <div class="panel-actions">
                <button class="btn btn-outline" data-action="clear-news-editor">
                  ã‚¯ãƒªã‚¢
                </button>
                <button class="btn btn-secondary" data-action="preview-news">
                  <i class="fas fa-eye"></i>
                  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
                </button>
                <button class="btn btn-primary" data-action="save-news">
                  <i class="fas fa-save"></i>
                  ä¿å­˜
                </button>
                <button class="btn btn-success" data-action="publish-news">
                  <i class="fas fa-globe"></i>
                  å…¬é–‹
                </button>
              </div>
            </div>
            
            <form class="editor-form">
              <input type="hidden" id="news-id">
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-title">
                    ã‚¿ã‚¤ãƒˆãƒ« <span class="required">*</span>
                  </label>
                  <input type="text" id="news-title" class="form-input" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" required>
                </div>
                <div class="form-group">
                  <label for="news-category">
                    ã‚«ãƒ†ã‚´ãƒªãƒ¼
                  </label>
                  <select id="news-category" class="form-select">
                    <option value="announcement">ãŠçŸ¥ã‚‰ã›</option>
                    <option value="event">ä½“é¨“ä¼š</option>
                    <option value="media">ãƒ¡ãƒ‡ã‚£ã‚¢</option>
                    <option value="important">é‡è¦</option>
                  </select>
                </div>
              </div>
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-date">
                    å…¬é–‹æ—¥
                  </label>
                  <input type="date" id="news-date" class="form-input">
                </div>
                <div class="form-group">
                  <label for="news-status">
                    ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
                  </label>
                  <select id="news-status" class="form-select">
                    <option value="draft">ä¸‹æ›¸ã</option>
                    <option value="published">å…¬é–‹</option>
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label for="news-summary">
                  æ¦‚è¦
                </label>
                <textarea id="news-summary" class="form-textarea" rows="3" placeholder="è¨˜äº‹ã®æ¦‚è¦ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆè¨˜äº‹ä¸€è¦§ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰"></textarea>
              </div>
              
              <div class="form-group">
                <label for="news-content">
                  æœ¬æ–‡ <span class="required">*</span>
                </label>
                <div class="editor-toolbar">
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="**" data-end="**" title="å¤ªå­—">
                    <strong>B</strong>
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="## " data-end="" title="è¦‹å‡ºã—">
                    H2
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="- " data-end="" title="ãƒªã‚¹ãƒˆ">
                    List
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="[" data-end="](URL)" title="ãƒªãƒ³ã‚¯">
                    Link
                  </button>
                  <div class="toolbar-separator"></div>
                  <button type="button" class="toolbar-btn help-btn" data-action="show-writing-guide" title="è¨˜äº‹ä½œæˆã‚¬ã‚¤ãƒ‰">
                    <i class="fas fa-question-circle"></i>
                    ã‚¬ã‚¤ãƒ‰
                  </button>
                </div>
                <textarea id="news-content" class="form-textarea editor-content" placeholder="è¨˜äº‹ã®æœ¬æ–‡ã‚’Markdownå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„" required></textarea>
                <div class="form-help">
                  <small>Markdownè¨˜æ³•: **å¤ªå­—**ã€## è¦‹å‡ºã—ã€- ãƒªã‚¹ãƒˆã€[ãƒªãƒ³ã‚¯](URL) | <a href="#" data-action="show-writing-guide" class="help-link">ğŸ“– è©³ç´°ãªè¨˜äº‹ä½œæˆã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</a></small>
                </div>
              </div>
              
              <div class="form-group">
                <label>
                  <input type="checkbox" id="news-featured"> æ³¨ç›®è¨˜äº‹ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹
                </label>
              </div>
            </form>
          </div>
        </div>
        
        <!-- è¨˜äº‹ä¸€è¦§ã‚¿ãƒ– -->
        <div id="news-list-tab" class="news-tab-content">
          <div class="list-panel full-width">
            <div class="panel-header">
              <h2><i class="fas fa-list"></i> è¨˜äº‹ä¸€è¦§</h2>
              <div class="panel-filters">
                <select id="news-filter" class="form-select" data-action="filter-news-list" data-target="news-filter">
                  <option value="all">ã™ã¹ã¦</option>
                  <option value="published">å…¬é–‹ä¸­</option>
                  <option value="draft">ä¸‹æ›¸ã</option>
                </select>
                <button class="btn btn-outline" data-action="refresh-news-list">
                  æ›´æ–°
                </button>
              </div>
            </div>
            <div id="news-list" class="list-content">
              <!-- è¨˜äº‹ä¸€è¦§ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
              <div class="loading-state">
                è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ -->
      <section id="lesson-status" class="admin-section">
        <div class="section-header">
          <h1><i class="fas fa-calendar-check"></i> ãƒ¬ãƒƒã‚¹ãƒ³é–‹å‚¬çŠ¶æ³</h1>
        </div>
        
        <div class="lesson-panel">
          <div class="panel-header">
            <h2>é–‹å‚¬çŠ¶æ³è¨­å®š</h2>
            <div class="status-display">
              <div class="status-item">
                <input type="radio" id="status-scheduled" name="global-status" value="é€šå¸¸é–‹å‚¬" checked>
                <label for="status-scheduled">é€šå¸¸é–‹å‚¬</label>
              </div>
              <div class="status-item">
                <input type="radio" id="status-cancelled" name="global-status" value="ä¸­æ­¢">
                <label for="status-cancelled">ä¸­æ­¢</label>
              </div>
              <div class="status-item">
                <input type="radio" id="status-indoor" name="global-status" value="å®¤å†…é–‹å‚¬">
                <label for="status-indoor">å®¤å†…é–‹å‚¬</label>
              </div>
              <div class="status-item">
                <input type="radio" id="status-postponed" name="global-status" value="å»¶æœŸ">
                <label for="status-postponed">å»¶æœŸ</label>
              </div>
            </div>
          </div>
          
          <div class="lesson-form">
            <div class="form-grid">
              <div class="form-group">
                <label for="lesson-date"><i class="fas fa-calendar"></i> å¯¾è±¡æ—¥</label>
                <input type="date" id="lesson-date" class="form-input" value="">
              </div>
              <div class="form-group">
                <label for="global-message"><i class="fas fa-comment"></i> å…¨ä½“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä»»æ„ï¼‰</label>
                <textarea id="global-message" class="form-textarea" rows="3" placeholder="ä¾‹ï¼šé›¨å¤©ã®ãŸã‚å®¤å†…ã§å®Ÿæ–½ã„ãŸã—ã¾ã™ã€‚"></textarea>
                <div class="form-help">
                  <small>ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®é–‹å‚¬çŠ¶æ³ã«è¡¨ç¤ºã•ã‚Œã¾ã™</small>
                </div>
              </div>
            </div>
            
            <div class="courses-grid">
              <div class="course-card">
                <div class="course-header">
                  <h3>ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚³ãƒ¼ã‚¹</h3>
                  <p>å¹´é•·ã€œå°3å¯¾è±¡ / 17:00-17:50</p>
                </div>
                <div class="course-content">
                  <div class="status-buttons">
                    <input type="radio" name="basic-lesson" value="é€šå¸¸é–‹å‚¬" id="basic-lesson-scheduled" checked>
                    <label for="basic-lesson-scheduled" class="status-btn">
                      <i class="fas fa-check-circle"></i>
                      é€šå¸¸é–‹å‚¬
                    </label>
                    <input type="radio" name="basic-lesson" value="ä¸­æ­¢" id="basic-lesson-cancelled">
                    <label for="basic-lesson-cancelled" class="status-btn">
                      <i class="fas fa-times-circle"></i>
                      ä¸­æ­¢
                    </label>
                    <input type="radio" name="basic-lesson" value="å®¤å†…é–‹å‚¬" id="basic-lesson-indoor">
                    <label for="basic-lesson-indoor" class="status-btn">
                      <i class="fas fa-home"></i>
                      å®¤å†…é–‹å‚¬
                    </label>
                    <input type="radio" name="basic-lesson" value="å»¶æœŸ" id="basic-lesson-postponed">
                    <label for="basic-lesson-postponed" class="status-btn">
                      <i class="fas fa-clock"></i>
                      å»¶æœŸ
                    </label>
                  </div>
                </div>
              </div>
              
              <div class="course-card">
                <div class="course-header">
                  <h3>ã‚¢ãƒ‰ãƒãƒ³ã‚¹ã‚³ãƒ¼ã‚¹</h3>
                  <p>å°4ã€œå°6å¯¾è±¡ / 18:00-18:50</p>
                </div>
                <div class="course-content">
                  <div class="status-buttons">
                    <input type="radio" name="advance-lesson" value="é€šå¸¸é–‹å‚¬" id="advance-lesson-scheduled" checked>
                    <label for="advance-lesson-scheduled" class="status-btn">
                      <i class="fas fa-check-circle"></i>
                      é€šå¸¸é–‹å‚¬
                    </label>
                    <input type="radio" name="advance-lesson" value="ä¸­æ­¢" id="advance-lesson-cancelled">
                    <label for="advance-lesson-cancelled" class="status-btn">
                      <i class="fas fa-times-circle"></i>
                      ä¸­æ­¢
                    </label>
                    <input type="radio" name="advance-lesson" value="å®¤å†…é–‹å‚¬" id="advance-lesson-indoor">
                    <label for="advance-lesson-indoor" class="status-btn">
                      <i class="fas fa-home"></i>
                      å®¤å†…é–‹å‚¬
                    </label>
                    <input type="radio" name="advance-lesson" value="å»¶æœŸ" id="advance-lesson-postponed">
                    <label for="advance-lesson-postponed" class="status-btn">
                      <i class="fas fa-clock"></i>
                      å»¶æœŸ
                    </label>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="form-actions">
              <button class="btn btn-secondary" data-action="load-lesson-status">
                <i class="fas fa-download"></i> ç¾åœ¨ã®çŠ¶æ³ã‚’èª­ã¿è¾¼ã¿
              </button>
              <button class="btn btn-success" data-action="update-lesson-status">
                <i class="fas fa-save"></i> ä¿å­˜ã—ã¦å…¬é–‹
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- è¨­å®š -->
      <section id="settings" class="admin-section">
        <div class="section-header">
          <h1><i class="fas fa-cog"></i> è¨­å®š</h1>
        </div>
        
        <div class="settings-panel">
          <div class="setting-group">
            <h3><i class="fas fa-database"></i> ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
            <p>è¨˜äº‹ã€InstagramæŠ•ç¨¿ã€ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ãƒ‡ãƒ¼ã‚¿ã®çµ±åˆç®¡ç†ã¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</p>
            <div class="setting-actions">
              <button class="btn btn-outline" data-action="export-data">
                <i class="fas fa-download"></i> å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
              </button>
              <button class="btn btn-outline" data-action="clear-all-data">
                <i class="fas fa-trash"></i> å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
              </button>
            </div>
            <small class="setting-note">
              <i class="fas fa-info-circle"></i>
              ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãŒæ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¼·åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚
            </small>
          </div>
          
          <div class="setting-group">
            <h3><i class="fas fa-link"></i> ã‚µã‚¤ãƒˆé€£æº</h3>
            <p>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µã‚¤ãƒˆã¨ã®é€£æºçŠ¶æ³</p>
            <div class="setting-actions">
              <button class="btn btn-primary" data-action="test-site-connection">
                <i class="fas fa-link"></i> é€£æºãƒ†ã‚¹ãƒˆ
              </button>
              <div id="site-connection-test-results" class="test-results" style="margin-top: 10px;"></div>
              <button class="btn btn-secondary" data-action="open-external" data-url="news.html">
                <i class="fas fa-external-link-alt"></i> ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã‚’é–‹ã
              </button>
            </div>
          </div>
          
          <div class="setting-group">
            <h3><i class="fas fa-tools"></i> é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«</h3>
            <p>é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯éè¡¨ç¤ºï¼‰</p>
            <div class="setting-actions">
              <button class="btn btn-info" data-action="show-debug-info">
                <i class="fas fa-info-circle"></i> ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤º
              </button>
              <button class="btn btn-info" data-action="show-news-debug">
                <i class="fas fa-bug"></i> ãƒ‹ãƒ¥ãƒ¼ã‚¹é€£æºãƒ‡ãƒãƒƒã‚°
              </button>
              <button class="btn btn-warning" data-action="reset-local-storage">
                <i class="fas fa-redo"></i> LocalStorage ãƒªã‚»ãƒƒãƒˆ
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title"></h3>
        <button class="modal-close" data-action="close-modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
      </div>
    </div>
  </div>

  <!-- é€šçŸ¥ã‚¨ãƒªã‚¢ -->
  <div id="notification-container" class="notification-container">
    <!-- é€šçŸ¥ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
  </div>

  <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ -->
  <script type="module">
    // ç®¡ç†ç”»é¢å°‚ç”¨ã®åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆApplication.jsã‚’ä½¿ã‚ãªã„ï¼‰
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        console.log('ğŸ—ï¸ ç®¡ç†ç”»é¢åˆæœŸåŒ–é–‹å§‹');
        
        // 1. èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ€åˆã«åˆæœŸåŒ–
        console.log('ğŸ” èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–ä¸­...');
        const { authService } = await import('../js/features/auth/services/AuthService.js');
        
        if (!authService.initialized) {
          console.log('ğŸ” èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–å®Ÿè¡Œä¸­...');
          await authService.init();
          console.log('âœ… èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–å®Œäº†');
        } else {
          console.log('â„¹ï¸ èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã¯æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿');
        }

        // èªè¨¼ãƒã‚§ãƒƒã‚¯
        console.log('ğŸ” èªè¨¼çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ä¸­...');
        if (!authService.checkAdminPageAuth()) {
          console.warn('âš ï¸ èªè¨¼å¤±æ•— - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ');
          return;
        }
        console.log('âœ… èªè¨¼ãƒã‚§ãƒƒã‚¯æˆåŠŸ');

        // 2. AdminActionServiceã‚’åˆæœŸåŒ–ï¼ˆActionManagerã‚‚å†…éƒ¨ã§åˆæœŸåŒ–ã•ã‚Œã‚‹ï¼‰
        console.log('ğŸ‘¨â€ğŸ’¼ AdminActionServiceã‚’åˆæœŸåŒ–ä¸­...');
        const { AdminActionService } = await import('../js/features/admin/services/AdminActionService.js');
        
        const adminActionService = new AdminActionService();
        console.log('ğŸ‘¨â€ğŸ’¼ AdminActionServiceåˆæœŸåŒ–å®Ÿè¡Œä¸­...');
        await adminActionService.init();
        console.log('âœ… AdminActionServiceåˆæœŸåŒ–å®Œäº†');

        // 3. ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’å…¬é–‹
        console.log('ğŸŒ ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹å…¬é–‹ä¸­...');
        window.adminActionService = adminActionService;
        window.actionManager = adminActionService.actionManager;
        window.uiManagerService = adminActionService.uiManagerService;
        window.authService = authService;
        console.log('âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹å…¬é–‹å®Œäº†');

        console.log('âœ… ç®¡ç†ç”»é¢åˆæœŸåŒ–å®Œäº†');
        
        // æˆåŠŸé€šçŸ¥
        if (window.showSuccess) {
          window.showSuccess('ç®¡ç†ç”»é¢ã‚’é–‹ãã¾ã—ãŸ', 2000);
        }
        
        // ãƒ‡ãƒãƒƒã‚°: ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã‚’å®šæœŸçš„ã«ãƒ­ã‚°å‡ºåŠ›ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
          console.log('ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›£è¦–é–‹å§‹');
          setInterval(() => {
            const sessionElement = document.getElementById('session-remaining');
            if (sessionElement) {
              console.log('ğŸ” ã‚»ãƒƒã‚·ãƒ§ãƒ³è¡¨ç¤º:', sessionElement.textContent);
            }
          }, 30000); // 30ç§’ã”ã¨
        }
        
      } catch (error) {
        console.error('âŒ ç®¡ç†ç”»é¢åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
        console.error('âŒ ã‚¨ãƒ©ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯:', error.stack);
        
        // ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’è¡¨ç¤º
        let errorMessage = `ç®¡ç†ç”»é¢ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n\nã‚¨ãƒ©ãƒ¼: ${error.message}`;
        if (error.stack) {
          errorMessage += `\n\nã‚¹ã‚¿ãƒƒã‚¯:\n${error.stack.split('\n').slice(0, 5).join('\n')}`;
        }
        
        // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        const shouldRedirect = confirm(errorMessage + '\n\nãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ');
        if (shouldRedirect) {
          window.location.href = 'admin-login.html';
        } else {
          // ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’ç¶­æŒã—ã¦ãƒ‡ãƒãƒƒã‚°ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
          console.error('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚è©³ç´°ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
          
          // ç°¡æ˜“ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’ç”»é¢ã«ä½œæˆ
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText = `
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: #fee;
            border: 2px solid #f00;
            padding: 20px;
            border-radius: 8px;
            z-index: 9999;
            font-family: monospace;
            font-size: 14px;
            max-height: 50vh;
            overflow-y: auto;
          `;
          errorDiv.innerHTML = `
            <h3 style="color: #c00; margin: 0 0 10px 0;">ç®¡ç†ç”»é¢åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</h3>
            <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${error.message}</p>
            <details>
              <summary>è©³ç´°ã‚¹ã‚¿ãƒƒã‚¯æƒ…å ±</summary>
              <pre style="margin: 10px 0; font-size: 12px;">${error.stack}</pre>
            </details>
            <button onclick="this.parentElement.remove()" style="
              background: #ccc;
              border: none;
              padding: 5px 10px;
              border-radius: 4px;
              cursor: pointer;
              margin-top: 10px;
            ">é–‰ã˜ã‚‹</button>
          `;
          document.body.appendChild(errorDiv);
        }
      }
    });
  </script>

  <!-- é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ãƒ‘ãƒ¼ -->
  <script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«é€šçŸ¥ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    window.showNotification = function(type, message, duration = 4000, options = {}) {
      if (window.uiManagerService) {
        return window.uiManagerService.showNotification(type, message, duration, options);
      } else {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚·ãƒ³ãƒ—ãƒ«ãªé€šçŸ¥
        console.log(`${type.toUpperCase()}: ${message}`);
        
        // ç°¡æ˜“é€šçŸ¥è¦ç´ ã‚’ä½œæˆ
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 80px;
          right: 24px;
          padding: 16px 20px;
          border-radius: 12px;
          color: white;
          font-weight: 600;
          z-index: 9999;
          max-width: 400px;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
          background: ${type === 'success' ? '#22c55e' : 
                      type === 'error' ? '#ef4444' : 
                      type === 'warning' ? '#f59e0b' : '#3b82f6'};
          transform: translateX(100%);
          transition: all 0.3s ease;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        setTimeout(() => {
          notification.style.transform = 'translateX(0)';
        }, 10);
        
        // è‡ªå‹•å‰Šé™¤
        setTimeout(() => {
          notification.style.transform = 'translateX(100%)';
          setTimeout(() => {
            if (notification.parentNode) {
              notification.remove();
            }
          }, 300);
        }, duration);
      }
    };
    
    // ä¾¿åˆ©ãªãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    window.showSuccess = (message, duration, options) => 
      window.showNotification('success', message, duration, options);
    
    window.showError = (message, duration, options) => 
      window.showNotification('error', message, duration, options);
    
    window.showWarning = (message, duration, options) => 
      window.showNotification('warning', message, duration, options);
    
    window.showInfo = (message, duration, options) => 
      window.showNotification('info', message, duration, options);
    
    // ActionManager ã‚¢ã‚¯ã‚»ã‚¹ãƒ˜ãƒ«ãƒ‘ãƒ¼
    window.registerAction = function(actionName, handler) {
      if (window.app && window.app.actionManager) {
        window.app.actionManager.register(actionName, handler);
        console.log(`âœ… ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç™»éŒ²: ${actionName}`);
      } else {
        console.warn(`âš ï¸ ActionManagerãŒåˆ©ç”¨ã§ãã¾ã›ã‚“: ${actionName}`);
      }
    };
    
    // ãƒ‡ãƒãƒƒã‚°ç”¨: ç™»éŒ²æ¸ˆã¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§è¡¨ç¤º
    window.listActions = function() {
      if (window.app && window.app.actionManager) {
        console.log('ğŸ“‹ ç™»éŒ²æ¸ˆã¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:', Array.from(window.app.actionManager._actions.keys()));
      } else {
        console.warn('âš ï¸ ActionManagerãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
      }
    };
    
    // console.logã‚’é€šçŸ¥ã§ã‚‚è¡¨ç¤ºã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã¿ï¼‰
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
      const originalLog = console.log;
      const originalWarn = console.warn;
      const originalError = console.error;
      
      // ç®¡ç†ç”»é¢ã§ã®é‡è¦ãªãƒ­ã‚°ã®ã¿é€šçŸ¥ã¨ã—ã¦è¡¨ç¤º
      console.log = function(...args) {
        originalLog.apply(console, args);
        
        const message = args.join(' ');
        if (message.includes('âœ…') && message.length < 100 && !message.includes('ActionManager')) {
          window.showSuccess(message.replace(/âœ…|ğŸ¯|ğŸ“±|ğŸ”§/g, '').trim(), 2000);
        }
      };
      
      console.warn = function(...args) {
        originalWarn.apply(console, args);
        
        const message = args.join(' ');
        if (message.includes('âš ï¸') && message.length < 100 && !message.includes('æœªç™»éŒ²')) {
          window.showWarning(message.replace(/âš ï¸/g, '').trim(), 4000);
        }
      };
      
      console.error = function(...args) {
        originalError.apply(console, args);
        
        const message = args.join(' ');
        if (message.includes('âŒ') && message.length < 100) {
          window.showError(message.replace(/âŒ/g, '').trim(), 6000);
        }
      };
    }
  </script>

  <script>
    // ä»Šæ—¥ã®æ—¥ä»˜ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®š
    document.addEventListener('DOMContentLoaded', function() {
      const lessonDateField = document.getElementById('lesson-date');
      if (lessonDateField && !lessonDateField.value) {
        lessonDateField.value = new Date().toISOString().slice(0, 10);
      }
    });
  </script>
</body>
</html> 