<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>管理画面 - RBS陸上教室</title>
  <meta name="description" content="RBS陸上教室の管理画面">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700;800;900&family=Nunito+Sans:wght@300;400;500;600;700;800;900&family=Noto+Sans+JP:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/components.css">
  <!-- 管理画面専用CSS（モジュラー版） -->
  <link rel="stylesheet" href="../css/admin/admin-core.css">
  <link rel="stylesheet" href="../css/admin/admin-components.css">
  <link rel="stylesheet" href="../css/admin/admin-features.css">
  <link rel="stylesheet" href="../css/admin/admin-responsive.css">
  <link rel="stylesheet" href="../css/admin/admin-preview.css">
  <link rel="stylesheet" href="../css/utilities/style-utils.css">
  <link rel="stylesheet" href="../css/news.css">
  <link rel="stylesheet" href="../css/components/lesson-status-admin.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="../assets/images/rds-logo.png">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="page-admin">
  <!-- ヘッダー -->
  <header class="admin-header">
    <div class="header-left">
      <i class="fas fa-running admin-logo-icon"></i>
      <span class="admin-logo-text">RBS陸上教室 管理画面</span>
    </div>
    <div class="header-right">
      <div class="notification-settings">
        <button class="notification-toggle-btn" id="notification-toggle" 
                title="通知設定を切り替え" 
                data-action="toggle-notification-mode">
          <i class="fas fa-bell-slash"></i>
          <span class="toggle-text">通知OFF</span>
        </button>
      </div>
      <div class="session-info" id="session-info">
        <i class="fas fa-clock"></i>
        <span id="session-remaining">初期化中...</span>
      </div>
      <button class="logout-btn" data-action="logout" title="ログアウト">
        <i class="fas fa-sign-out-alt"></i>
        ログアウト
      </button>
    </div>
  </header>

  <!-- メインコンテンツ -->
  <div class="admin-container">
    <!-- サイドバー -->
    <aside class="admin-sidebar">
      <nav class="sidebar-nav">
        <div class="nav-item active" data-tab="dashboard" data-action="switch-admin-tab">
          <i class="fas fa-chart-line"></i>
          <span>ダッシュボード</span>
        </div>
        <div class="nav-item" data-tab="news-management" data-action="switch-admin-tab">
          <i class="fas fa-newspaper"></i>
          <span>記事管理</span>
        </div>
        <div class="nav-item" data-tab="lesson-status" data-action="switch-admin-tab">
          <i class="fas fa-calendar-check"></i>
          <span>レッスン状況</span>
        </div>
        <div class="nav-item" data-tab="instagram-management" data-action="switch-admin-tab">
          <i class="fab fa-instagram"></i>
          <span>Instagram管理</span>
        </div>
        <div class="nav-item" data-tab="settings" data-action="switch-admin-tab">
          <i class="fas fa-cog"></i>
          <span>設定</span>
        </div>
      </nav>
    </aside>

    <!-- メインエリア -->
    <main class="admin-main dashboard-optimized" id="admin-main">
      <!-- ダッシュボードタブ -->
      <div class="admin-section active" id="dashboard">
        <div class="section-header">
          <h1><i class="fas fa-chart-line"></i> ダッシュボード</h1>
        </div>

        <!-- 統計カード -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon published">
              <i class="fas fa-newspaper"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-published">0</div>
              <div class="stat-label">公開記事</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon draft">
              <i class="fas fa-edit"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-drafts">0</div>
              <div class="stat-label">下書き</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon instagram-visible">
              <i class="fab fa-instagram"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-instagram-visible">0</div>
              <div class="stat-label">表示中投稿</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon instagram-hidden">
              <i class="fas fa-eye-slash"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-instagram-hidden">0</div>
              <div class="stat-label">非表示投稿</div>
            </div>
          </div>
        </div>

        <!-- ダッシュボードウィジェット -->
        <div class="dashboard-widgets">
          <div class="widget recent-articles-widget">
            <div class="widget-header">
              <h2><i class="fas fa-newspaper"></i> 最近の記事</h2>
              <div class="widget-header-actions">
                <button class="btn-icon" data-action="refresh-recent-articles" title="更新">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            <div class="widget-content">
              <div id="recent-articles" class="admin-news-container">
                <div class="loading-state">
                  <i class="fas fa-spinner fa-spin"></i>
                  記事を読み込み中...
                </div>
              </div>
            </div>
          </div>

          <!-- クイックアクション -->
          <div class="widget quick-actions">
            <div class="widget-header">
              <h2><i class="fas fa-bolt"></i> クイックアクション</h2>
            </div>
            <div class="widget-content">
              <div class="action-buttons-grid">
                <!-- 新規記事作成 -->
                <button class="action-btn compact success" data-action="new-news-article">
                  <div class="action-icon">
                    <i class="fas fa-plus"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">新規記事作成</span>
                    <span class="action-desc">新しいニュース記事を作成</span>
                  </div>
                </button>

                <!-- データエクスポート -->
                <button class="action-btn compact info" data-action="export-data">
                  <div class="action-icon">
                    <i class="fas fa-download"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">データエクスポート</span>
                    <span class="action-desc">記事データをダウンロード</span>
                  </div>
                </button>

                <!-- レッスン状況更新 -->
                <button class="action-btn compact warning" data-action="update-lesson-status">
                  <div class="action-icon">
                    <i class="fas fa-calendar-check"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">レッスン状況</span>
                    <span class="action-desc">練習状況を更新</span>
                  </div>
                </button>

                <!-- 設定ページへのリンク -->
                <button class="action-btn compact secondary" data-action="switch-admin-tab" data-tab="settings">
                  <div class="action-icon">
                    <i class="fas fa-cog"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">システム設定</span>
                    <span class="action-desc">管理画面の設定</span>
                  </div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 記事管理タブ -->
      <div class="admin-section" id="news-management">
        <div class="section-header">
          <h1><i class="fas fa-newspaper"></i> 記事管理</h1>
        </div>
        
        <!-- 記事管理用のタブナビゲーション -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-news-tab" data-tab="editor">
            <i class="fas fa-edit"></i>
            新規記事作成
          </div>
          <div class="sub-nav-item" data-action="switch-news-tab" data-tab="list">
            <i class="fas fa-list"></i>
            記事一覧
          </div>
        </div>
        
        <!-- エディタータブ -->
        <div id="news-editor-tab" class="news-tab-content active">
          <div class="editor-panel">
            <div class="panel-header">
              <h2><i class="fas fa-edit"></i> <span id="editor-title">新規記事作成</span></h2>
              <div class="panel-actions">
                <button class="btn-editor btn-clear" data-action="clear-news-editor">
                  <i class="fas fa-undo"></i>
                  クリア
                </button>
                <button class="btn-editor btn-preview" data-action="preview-news">
                  <i class="fas fa-eye"></i>
                  プレビュー
                </button>
                <button class="btn-editor btn-save" data-action="save-news">
                  <i class="fas fa-save"></i>
                  下書き保存
                </button>
                <button class="btn-editor btn-publish" data-action="publish-news">
                  <i class="fas fa-globe"></i>
                  公開
                </button>
              </div>
            </div>
            
            <form class="editor-form">
              <input type="hidden" id="news-id">
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-title">
                    タイトル <span class="required">*</span>
                  </label>
                  <input type="text" id="news-title" class="form-input" placeholder="記事のタイトルを入力してください" required>
                </div>
                <div class="form-group">
                  <label for="news-category">
                    カテゴリー
                  </label>
                  <select id="news-category" class="form-select">
                    <option value="announcement">お知らせ</option>
                    <option value="event">体験会</option>
                    <option value="media">メディア</option>
                    <option value="important">重要</option>
                  </select>
                </div>
              </div>
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-date">
                    公開日
                  </label>
                  <input type="date" id="news-date" class="form-input">
                </div>

              </div>
              
              <div class="form-group">
                <label for="news-summary">
                  概要
                </label>
                <textarea id="news-summary" class="form-textarea" rows="3" placeholder="記事の概要を入力してください（記事一覧で表示されます）"></textarea>
              </div>
              
              <div class="form-group">
                <label for="news-content">
                  本文 <span class="required">*</span>
                </label>
                <div class="editor-toolbar">
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="**" data-end="**" title="太字">
                    <strong>B</strong>
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="## " data-end="" title="見出し">
                    H2
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="- " data-end="" title="リスト">
                    List
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="[" data-end="](URL)" title="リンク">
                    Link
                  </button>
                  <button type="button" class="toolbar-btn help-btn" data-action="show-writing-guide" title="記事作成ガイド">
                    <i class="fas fa-book-open"></i>
                    ガイド
                  </button>
                </div>
                <textarea id="news-content" class="form-textarea editor-content" placeholder="記事の本文をMarkdown形式で入力してください" required></textarea>
                <div class="form-help">
                  <small>Markdown記法: **太字**、## 見出し、- リスト、[リンク](URL)</small>
                </div>
              </div>
              
              <div class="form-group">
                <label>
                  <input type="checkbox" id="news-featured"> 注目記事として表示する
                </label>
              </div>
            </form>
          </div>
        </div>
        
        <!-- 記事一覧タブ -->
        <div id="news-list-tab" class="news-tab-content">
          <div class="list-panel full-width">
            <div class="panel-header">
              <h2><i class="fas fa-list"></i> 記事一覧</h2>
              <div class="panel-filters">
                <select id="news-filter" class="form-select" data-action="filter-news-list" data-target="news-filter">
                  <option value="all">すべて</option>
                  <option value="published">公開中</option>
                  <option value="draft">下書き</option>
                </select>
                <button class="btn btn-outline" data-action="refresh-news-list">
                  更新
                </button>
              </div>
            </div>
            <div id="news-list" class="list-content admin-news-container">
              <!-- 記事一覧がここに表示される -->
              <div class="loading-state">
                記事を読み込み中...
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- レッスン状況タブ -->
      <div class="admin-section" id="lesson-status">
        <div class="section-header">
          <h1><i class="fas fa-calendar-check"></i> レッスン状況管理</h1>
        </div>

        <!-- 現在の状況表示 -->
        <div class="current-status-card">
          <div class="status-header">
            <h3><i class="fas fa-info-circle"></i> 現在の状況</h3>
            <span class="status-date" id="current-status-date">今日</span>
          </div>
          <div class="status-display" id="current-status-display">
            <div class="status-indicator">
              <i class="fas fa-check-circle status-icon"></i>
              <span class="status-text">通常開催</span>
            </div>
            <div class="status-updated">
              最終更新: <span id="last-updated">-</span>
            </div>
          </div>
        </div>

        <!-- 設定フォーム -->
        <div class="lesson-form-container">
          <div class="form-header">
            <h3><i class="fas fa-edit"></i> レッスン状況を設定</h3>
            <div class="form-controls">
              <input type="date" id="lesson-date" class="date-input">
              <button class="btn btn-outline" data-action="load-lesson-status" id="load-btn">
                <i class="fas fa-download"></i> 読み込み
              </button>
            </div>
          </div>

          <form class="lesson-form" id="lesson-form">
            <!-- 全体ステータス -->
            <div class="form-section">
              <label class="section-label">
                <i class="fas fa-bullhorn"></i>
                全体開催ステータス
              </label>
              <div class="status-options">
                <label class="status-option">
                  <input type="radio" name="global-status" value="scheduled" checked>
                  <div class="option-card scheduled">
                    <i class="fas fa-check-circle"></i>
                    <span>通常開催</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="cancelled">
                  <div class="option-card cancelled">
                    <i class="fas fa-times-circle"></i>
                    <span>中止</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="indoor">
                  <div class="option-card indoor">
                    <i class="fas fa-home"></i>
                    <span>室内開催</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="postponed">
                  <div class="option-card postponed">
                    <i class="fas fa-clock"></i>
                    <span>延期</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- 全体メッセージ -->
            <div class="form-section">
              <label for="global-message" class="section-label">
                <i class="fas fa-comment"></i>
                全体向けメッセージ（任意）
              </label>
              <textarea id="global-message" placeholder="保護者向けの追加メッセージがあれば入力してください" rows="3"></textarea>
            </div>

            <!-- コース別設定 -->
            <div class="form-section">
              <label class="section-label">
                <i class="fas fa-users"></i>
                コース別設定
              </label>
              
              <div class="course-settings">
                <!-- ベーシックコース -->
                <div class="course-card">
                  <div class="course-header">
                    <h4>ベーシックコース</h4>
                    <span class="course-time">17:00 - 17:50</span>
                  </div>
                  <div class="course-options">
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="scheduled" checked>
                      <span class="option-text scheduled">
                        <i class="fas fa-check-circle"></i>
                        通常開催
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="cancelled">
                      <span class="option-text cancelled">
                        <i class="fas fa-times-circle"></i>
                        中止
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="indoor">
                      <span class="option-text indoor">
                        <i class="fas fa-home"></i>
                        室内開催
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="postponed">
                      <span class="option-text postponed">
                        <i class="fas fa-clock"></i>
                        延期
                      </span>
                    </label>
                  </div>
                </div>

                <!-- アドバンスコース -->
                <div class="course-card">
                  <div class="course-header">
                    <h4>アドバンスコース</h4>
                    <span class="course-time">18:00 - 18:50</span>
                  </div>
                  <div class="course-options">
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="scheduled" checked>
                      <span class="option-text scheduled">
                        <i class="fas fa-check-circle"></i>
                        通常開催
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="cancelled">
                      <span class="option-text cancelled">
                        <i class="fas fa-times-circle"></i>
                        中止
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="indoor">
                      <span class="option-text indoor">
                        <i class="fas fa-home"></i>
                        室内開催
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="postponed">
                      <span class="option-text postponed">
                        <i class="fas fa-clock"></i>
                        延期
                      </span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- アクションボタン -->
            <div class="form-actions panel-actions">
              <button type="button" class="btn-editor btn-preview" data-action="preview-lesson-status">
                <i class="fas fa-eye"></i>
                プレビュー
              </button>
              <button type="button" class="btn-editor btn-save" data-action="save-draft-lesson-status">
                <i class="fas fa-save"></i>
                下書き保存
              </button>
              <button type="button" class="btn-editor btn-publish" data-action="update-lesson-status">
                <i class="fas fa-upload"></i>
                保存して公開
              </button>
            </div>
          </form>
        </div>

        <!-- プレビューエリア -->
        <div class="preview-container preview-hidden" id="preview-container">
          <div class="preview-header">
            <h3><i class="fas fa-eye"></i> プレビュー</h3>
            <button class="btn btn-sm" onclick="this.closest('.preview-container').classList.add('preview-hidden'); this.closest('.preview-container').classList.remove('preview-visible');">
              <i class="fas fa-times"></i> 閉じる
            </button>
          </div>
          <div class="preview-content" id="preview-content">
            <!-- プレビュー内容 -->
          </div>
        </div>
      </div>

      <!-- Instagram管理タブ -->
      <div class="admin-section" id="instagram-management">
        <div class="section-header">
          <h1><i class="fab fa-instagram"></i> Instagram管理</h1>
        </div>
        
        <!-- Instagram管理用のタブナビゲーション -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-instagram-tab" data-tab="posts">
            <i class="fas fa-images"></i>
            投稿管理
          </div>
          <div class="sub-nav-item" data-action="switch-instagram-tab" data-tab="settings">
            <i class="fas fa-cog"></i>
            Instagram設定
          </div>
        </div>
        
        <!-- 投稿管理タブ -->
        <div id="instagram-posts-tab" class="instagram-tab-content active">
          <div class="instagram-simple-layout">
            <!-- 投稿追加フォーム -->
            <div class="instagram-add-form">
              <div class="form-header">
                <h2><i class="fab fa-instagram"></i> Instagram投稿を追加</h2>
              </div>
              
              <form class="simple-form" id="instagram-post-form">
                <input type="hidden" id="instagram-post-id">
                
                <div class="embed-input-group">
                  <textarea id="instagram-embed-code" 
                           class="embed-textarea" 
                           placeholder="" 
                           rows="8"
                           required></textarea>
                  <div class="embed-hint">
                    <i class="fas fa-info-circle"></i>
                    Instagram投稿ページで「埋め込み」を選択してコードをコピーし、上記に貼り付けてください
                  </div>
                  <button type="button" class="add-btn" data-action="save-instagram-post">
                    <i class="fas fa-plus"></i>
                    追加
                  </button>
                </div>
                
                <div class="settings-row">
                  <label class="toggle-switch">
                    <input type="checkbox" id="instagram-status" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">表示する</span>
                  </label>
                  
                  <label class="featured-checkbox">
                    <input type="checkbox" id="instagram-featured">
                    <span class="checkmark"></span>
                    <span class="featured-label">
                      <i class="fas fa-star"></i>
                      注目投稿
                    </span>
                  </label>
                </div>
              </form>
            </div>

            <!-- 投稿一覧 -->
            <div class="instagram-posts-container">
              <div class="posts-header">
                <h3><i class="fas fa-images"></i> 登録済み投稿</h3>
                <div class="posts-actions">
                  <select id="instagram-filter" class="filter-select" data-action="filter-instagram-list">
                    <option value="all">すべて</option>
                    <option value="active">表示中</option>
                    <option value="inactive">非表示</option>
                    <option value="featured">注目投稿</option>
                  </select>
                </div>
              </div>
              
              <div id="instagram-posts-list" class="posts-grid">
                <div class="loading-state">
                  <i class="fas fa-spinner fa-spin"></i>
                  Instagram投稿を読み込み中...
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Instagram設定タブ -->
        <div id="instagram-settings-tab" class="instagram-tab-content">
          <div class="instagram-simple-layout">
            
            <!-- 統計情報 -->
            <div class="stats-overview">
              <div class="section-header">
                <h2><i class="fas fa-chart-line"></i> Instagram投稿統計</h2>
                <div class="header-actions">
                  <button class="btn-icon" data-action="refresh-instagram-posts" title="統計を更新">
                    <i class="fas fa-sync-alt"></i>
                  </button>
                </div>
              </div>
              <div class="stats-grid">
                <div class="stat-card">
                  <div class="stat-icon total">
                    <i class="fab fa-instagram"></i>
                  </div>
                  <div class="stat-content">
                    <div class="stat-number" id="total-posts">0</div>
                    <div class="stat-label">総投稿数</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon instagram-visible">
                    <i class="fas fa-eye"></i>
                  </div>
                  <div class="stat-content">
                    <div class="stat-number" id="active-posts">0</div>
                    <div class="stat-label">表示中</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon featured">
                    <i class="fas fa-star"></i>
                  </div>
                  <div class="stat-content">
                    <div class="stat-number" id="featured-posts">0</div>
                    <div class="stat-label">注目投稿</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon instagram-hidden">
                    <i class="fas fa-eye-slash"></i>
                  </div>
                  <div class="stat-content">
                    <div class="stat-number" id="inactive-posts">0</div>
                    <div class="stat-label">非表示</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 表示設定 -->
            <div class="widget display-settings">
              <div class="widget-header">
                <h2><i class="fas fa-cog"></i> Instagram表示設定</h2>
                <div class="widget-header-actions">
                  <button class="btn-icon" data-action="reset-instagram-settings" title="デフォルトに戻す">
                    <i class="fas fa-undo"></i>
                  </button>
                </div>
              </div>
              <div class="widget-content">
                <form class="settings-form" id="instagram-settings-form">
                  <div class="form-grid">
                    <div class="form-group">
                      <label for="max-posts-display" class="form-label">
                        <i class="fas fa-list-ol"></i>
                        最大表示件数
                      </label>
                      <select id="max-posts-display" class="form-select">
                        <!-- 動的に生成される -->
                      </select>
                      <small class="form-help">フロントページに表示するInstagram投稿の最大件数</small>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-external-link-alt"></i>
                        リンク動作
                      </label>
                      <label class="toggle-switch">
                        <input type="checkbox" id="open-new-tab" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">新しいタブで開く</span>
                      </label>
                      <small class="form-help">Instagram投稿をクリックした際の動作を設定</small>
                    </div>
                  </div>

                  <div class="form-actions">
                    <button type="button" class="btn btn-primary" data-action="save-instagram-settings">
                      <i class="fas fa-save"></i>
                      設定を保存
                    </button>
                    <button type="button" class="btn btn-outline" data-action="test-instagram-settings">
                      <i class="fas fa-eye"></i>
                      プレビュー
                    </button>
                  </div>
                </form>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- 設定タブ -->
      <div class="admin-section" id="settings">
        <div class="section-header">
          <h1><i class="fas fa-cog"></i> 設定</h1>
        </div>

        <!-- 設定用のタブナビゲーション -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-settings-tab" data-tab="data">
            <i class="fas fa-database"></i>
            データ管理
          </div>
          <div class="sub-nav-item" data-action="switch-settings-tab" data-tab="system">
            <i class="fas fa-sliders-h"></i>
            システム設定
          </div>
          <div class="sub-nav-item" data-action="switch-settings-tab" data-tab="connection">
            <i class="fas fa-link"></i>
            サイト連携
          </div>
          <div class="sub-nav-item" data-action="switch-settings-tab" data-tab="developer">
            <i class="fas fa-tools"></i>
            開発者ツール
          </div>
        </div>

        <!-- データ管理タブ -->
        <div id="settings-data-tab" class="settings-tab-content active">
          <!-- システム統計 -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon published">
                <i class="fas fa-newspaper"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number" id="total-articles">0</div>
                <div class="stat-label">記事総数</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon instagram-visible">
                <i class="fab fa-instagram"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number" id="total-instagram">0</div>
                <div class="stat-label">Instagram投稿</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon draft">
                <i class="fas fa-calendar-check"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number" id="total-lessons">0</div>
                <div class="stat-label">レッスン記録</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon total">
                <i class="fas fa-hdd"></i>
              </div>
              <div class="stat-content">
                <div class="stat-number" id="storage-usage">-</div>
                <div class="stat-label">ストレージ使用量</div>
              </div>
            </div>
          </div>

          <!-- データ管理アクション -->
          <div class="dashboard-widgets">
            <div class="widget quick-actions">
              <div class="widget-header">
                <h2><i class="fas fa-database"></i> データ操作</h2>
                <div class="widget-header-actions">
                  <button class="btn-icon" data-action="refresh-data-stats" title="統計を更新">
                    <i class="fas fa-sync-alt"></i>
                  </button>
                </div>
              </div>
              <div class="widget-content">
                <div class="action-buttons-grid">
                  <button class="action-btn compact success" data-action="export-data">
                    <div class="action-icon">
                      <i class="fas fa-download"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">データエクスポート</span>
                      <span class="action-desc">全データをJSONでダウンロード</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact info" data-action="import-data">
                    <div class="action-icon">
                      <i class="fas fa-upload"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">データインポート</span>
                      <span class="action-desc">バックアップファイルから復元</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact secondary" data-action="backup-data">
                    <div class="action-icon">
                      <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">自動バックアップ</span>
                      <span class="action-desc">定期的なデータ保護を設定</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact warning" data-action="clear-all-data">
                    <div class="action-icon">
                      <i class="fas fa-trash"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">全データクリア</span>
                      <span class="action-desc">すべてのデータを削除（要注意）</span>
                    </div>
                  </button>
                </div>
                
                <div class="widget-info">
                  <i class="fas fa-info-circle"></i>
                  <p>エクスポート機能では記事、Instagram投稿、レッスン状況データを統合したJSONファイルをダウンロードできます。</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- システム設定タブ -->
        <div id="settings-system-tab" class="settings-tab-content">
          <div class="dashboard-widgets">
            <!-- 管理画面設定ウィジェット -->
            <div class="widget">
              <div class="widget-header">
                <h2><i class="fas fa-sliders-h"></i> 管理画面設定</h2>
              </div>
              <div class="widget-content">
                <div class="settings-form">
                  <div class="form-grid">
                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-bell"></i>
                        通知設定
                      </label>
                      <label class="toggle-switch">
                        <input type="checkbox" id="notification-mode" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">通知を有効にする</span>
                      </label>
                      <small class="form-help">操作の完了やエラーの通知を表示します</small>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-bug"></i>
                        デバッグモード
                      </label>
                      <label class="toggle-switch">
                        <input type="checkbox" id="debug-mode">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">デバッグモードを有効にする</span>
                      </label>
                      <small class="form-help">開発者向けのデバッグ情報を表示します</small>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-clock"></i>
                        自動保存間隔
                      </label>
                      <select id="auto-save-interval" class="form-select">
                        <option value="30">30秒</option>
                        <option value="60" selected>1分</option>
                        <option value="120">2分</option>
                        <option value="300">5分</option>
                        <option value="0">無効</option>
                      </select>
                      <small class="form-help">記事編集時の自動保存間隔を設定できます</small>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-palette"></i>
                        テーマ設定
                      </label>
                      <select id="admin-theme" class="form-select">
                        <option value="light" selected>ライトテーマ</option>
                        <option value="dark">ダークテーマ</option>
                        <option value="auto">システム設定に従う</option>
                      </select>
                      <small class="form-help">管理画面の外観テーマを選択できます</small>
                    </div>
                  </div>

                  <div class="form-actions">
                    <button class="btn btn-primary" data-action="save-admin-settings">
                      <i class="fas fa-save"></i>
                      設定を保存
                    </button>
                    <button class="btn btn-outline" data-action="reset-admin-settings">
                      <i class="fas fa-undo"></i>
                      デフォルトに戻す
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- セキュリティ設定 -->
            <div class="widget">
              <div class="widget-header">
                <h2><i class="fas fa-shield-alt"></i> セキュリティ設定</h2>
              </div>
              <div class="widget-content">
                <div class="settings-form">
                  <div class="form-grid">
                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-lock"></i>
                        セッション管理
                      </label>
                      <div class="session-info-display">
                        <div class="info-item">
                          <span class="info-label">セッション時間:</span>
                          <span class="info-value" id="session-time">取得中...</span>
                        </div>
                        <div class="info-item">
                          <span class="info-label">最終アクセス:</span>
                          <span class="info-value" id="last-access">取得中...</span>
                        </div>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        <i class="fas fa-user-shield"></i>
                        アクセス制御
                      </label>
                      <label class="toggle-switch">
                        <input type="checkbox" id="ip-restriction" disabled>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">IP制限を有効にする（準備中）</span>
                      </label>
                      <small class="form-help">特定のIPアドレスからのみアクセスを許可します</small>
                    </div>
                  </div>

                  <div class="form-actions">
                    <button class="btn btn-outline" data-action="logout">
                      <i class="fas fa-sign-out-alt"></i>
                      ログアウト
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- サイト連携タブ -->
        <div id="settings-connection-tab" class="settings-tab-content">
          <div class="dashboard-widgets">
            <!-- サイト連携ウィジェット -->
            <div class="widget">
              <div class="widget-header">
                <h2><i class="fas fa-link"></i> サイト連携</h2>
              </div>
              <div class="widget-content">
                <div class="settings-form">
                  <div class="form-group">
                    <label class="form-label">
                      <i class="fas fa-globe"></i>
                      フロントエンドサイトとの連携状況
                    </label>
                    <div id="site-connection-test-results" class="test-results hidden">
                      <!-- 連携テスト結果がここに表示される -->
                    </div>
                  </div>
                  
                  <div class="form-actions">
                    <button class="btn btn-primary" data-action="test-site-connection">
                      <i class="fas fa-link"></i>
                      連携テスト
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 外部サイトアクセス -->
            <div class="widget quick-actions">
              <div class="widget-header">
                <h2><i class="fas fa-external-link-alt"></i> 外部ページアクセス</h2>
              </div>
              <div class="widget-content">
                <div class="action-buttons-grid">
                  <button class="action-btn compact info" data-action="open-external" data-url="../index.html">
                    <div class="action-icon">
                      <i class="fas fa-home"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">ホームページ</span>
                      <span class="action-desc">メインサイトを確認</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact success" data-action="open-external" data-url="news.html">
                    <div class="action-icon">
                      <i class="fas fa-newspaper"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">ニュースページ</span>
                      <span class="action-desc">記事一覧を確認</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact secondary" data-action="preview-site">
                    <div class="action-icon">
                      <i class="fas fa-eye"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">サイトプレビュー</span>
                      <span class="action-desc">変更内容を事前確認</span>
                    </div>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 開発者ツールタブ -->
        <div id="settings-developer-tab" class="settings-tab-content">
          <div class="dashboard-widgets">
            <!-- 開発者ツールウィジェット -->
            <div class="widget">
              <div class="widget-header">
                <h2><i class="fas fa-tools"></i> 開発者ツール</h2>
                <div class="widget-header-actions">
                  <span class="badge badge-info">開発用</span>
                </div>
              </div>
              <div class="widget-content">
                <div class="action-buttons-grid">
                  <button class="action-btn compact info" data-action="show-debug-info">
                    <div class="action-icon">
                      <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">システム情報</span>
                      <span class="action-desc">デバッグ情報を表示</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact info" data-action="show-news-debug">
                    <div class="action-icon">
                      <i class="fas fa-newspaper"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">記事システム</span>
                      <span class="action-desc">記事データをデバッグ</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact info" data-action="show-instagram-debug">
                    <div class="action-icon">
                      <i class="fab fa-instagram"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">Instagram投稿</span>
                      <span class="action-desc">投稿データをデバッグ</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact info" data-action="show-storage-info">
                    <div class="action-icon">
                      <i class="fas fa-database"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">ストレージ情報</span>
                      <span class="action-desc">ローカルストレージ状況</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact warning" data-action="reset-local-storage">
                    <div class="action-icon">
                      <i class="fas fa-redo"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">ストレージリセット</span>
                      <span class="action-desc">全データを初期化</span>
                    </div>
                  </button>
                  
                  <button class="action-btn compact secondary" data-action="download-logs">
                    <div class="action-icon">
                      <i class="fas fa-file-download"></i>
                    </div>
                    <div class="action-content">
                      <span class="action-title">ログダウンロード</span>
                      <span class="action-desc">エラーログを取得</span>
                    </div>
                  </button>
                </div>
                
                <div class="widget-info warning">
                  <i class="fas fa-exclamation-triangle"></i>
                  <p>これらの機能は開発・デバッグ用です。本番環境では使用しないでください。</p>
                </div>
              </div>
            </div>

            <!-- パフォーマンス監視 -->
            <div class="widget">
              <div class="widget-header">
                <h2><i class="fas fa-tachometer-alt"></i> パフォーマンス監視</h2>
              </div>
              <div class="widget-content">
                <div class="performance-metrics">
                  <div class="metric-item">
                    <span class="metric-label">ページ読み込み時間:</span>
                    <span class="metric-value" id="load-time">計測中...</span>
                  </div>
                  <div class="metric-item">
                    <span class="metric-label">JavaScriptエラー:</span>
                    <span class="metric-value" id="js-errors">0</span>
                  </div>
                  <div class="metric-item">
                    <span class="metric-label">API応答時間:</span>
                    <span class="metric-value" id="api-response">-</span>
                  </div>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-outline" data-action="clear-performance-data">
                    <i class="fas fa-trash"></i>
                    パフォーマンスデータをクリア
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- モーダル -->
  <div id="modal" class="modal modal-hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title"></h3>
        <button class="modal-close" data-action="close-modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- プレビュー内容がここに表示される -->
      </div>
    </div>
  </div>

  <!-- 通知エリア -->
  <div id="notification-container" class="notification-container">
    <!-- 通知がここに表示される -->
  </div>

  <!-- 統合管理画面初期化システム -->
  <script type="module">
    import { initializeAdmin } from '../js/features/admin/core/AdminCore.js';
    
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // 新しい統合システムで初期化
        await initializeAdmin();
      } catch (error) {
        console.error('❌ 統合管理画面初期化エラー:', error);
      }
    });
  </script>

  <!-- 
    通知システム、デバッグヘルパー、統計更新機能は
    AdminNotificationService、DashboardStatsWidget、AdminCoreに統合されました
  -->

  <!-- 
    Instagram埋め込みスクリプト管理は
    InstagramEmbedModuleに統合されました
  -->
</body>
</html>