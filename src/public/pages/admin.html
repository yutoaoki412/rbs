<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç®¡ç†ç”»é¢ - RBSé™¸ä¸Šæ•™å®¤</title>
  <meta name="description" content="RBSé™¸ä¸Šæ•™å®¤ã®ç®¡ç†ç”»é¢">
  <meta name="robots" content="noindex, nofollow">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700;800;900&family=Nunito+Sans:wght@300;400;500;600;700;800;900&family=Noto+Sans+JP:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/components.css">
  <link rel="stylesheet" href="../css/admin.css">
  <link rel="stylesheet" href="../css/utilities/style-utils.css">
  <link rel="stylesheet" href="../css/components/recent-articles.css">
  <link rel="stylesheet" href="../css/components/lesson-status-admin.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="../assets/images/rds-logo.png">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="page-admin">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="admin-header">
    <div class="header-left">
      <i class="fas fa-running admin-logo-icon"></i>
      <span class="admin-logo-text">RBSé™¸ä¸Šæ•™å®¤ ç®¡ç†ç”»é¢</span>
    </div>
    <div class="header-right">
      <div class="notification-settings">
        <button class="notification-toggle-btn" id="notification-toggle" 
                title="é€šçŸ¥è¨­å®šã‚’åˆ‡ã‚Šæ›¿ãˆ" 
                data-action="toggle-notification-mode">
          <i class="fas fa-bell-slash"></i>
          <span class="toggle-text">é€šçŸ¥OFF</span>
        </button>
      </div>
      <div class="session-info" id="session-info">
        <i class="fas fa-clock"></i>
        <span id="session-remaining">åˆæœŸåŒ–ä¸­...</span>
      </div>
      <button class="logout-btn" data-action="logout" title="ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ">
        <i class="fas fa-sign-out-alt"></i>
        ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
      </button>
    </div>
  </header>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div class="admin-container">
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <aside class="admin-sidebar">
      <nav class="sidebar-nav">
        <div class="nav-item active" data-tab="dashboard" data-action="switch-admin-tab">
          <i class="fas fa-chart-line"></i>
          <span>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
        </div>
        <div class="nav-item" data-tab="news-management" data-action="switch-admin-tab">
          <i class="fas fa-newspaper"></i>
          <span>è¨˜äº‹ç®¡ç†</span>
        </div>
        <div class="nav-item" data-tab="lesson-status" data-action="switch-admin-tab">
          <i class="fas fa-calendar-check"></i>
          <span>ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³</span>
        </div>
        <div class="nav-item" data-tab="instagram-management" data-action="switch-admin-tab">
          <i class="fab fa-instagram"></i>
          <span>Instagramç®¡ç†</span>
        </div>
        <div class="nav-item" data-tab="settings" data-action="switch-admin-tab">
          <i class="fas fa-cog"></i>
          <span>è¨­å®š</span>
        </div>
      </nav>
    </aside>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
    <main class="admin-main dashboard-optimized" id="admin-main">
      <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ– -->
      <div class="admin-section active" id="dashboard">
        <div class="section-header">
          <h1><i class="fas fa-chart-line"></i> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        </div>

        <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon published">
              <i class="fas fa-newspaper"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-published">0</div>
              <div class="stat-label">å…¬é–‹è¨˜äº‹</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon draft">
              <i class="fas fa-edit"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-drafts">0</div>
              <div class="stat-label">ä¸‹æ›¸ã</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon instagram-visible">
              <i class="fab fa-instagram"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-instagram-visible">0</div>
              <div class="stat-label">è¡¨ç¤ºä¸­æŠ•ç¨¿</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon instagram-hidden">
              <i class="fas fa-eye-slash"></i>
            </div>
            <div class="stat-content">
              <div class="stat-number" id="stat-instagram-hidden">0</div>
              <div class="stat-label">éè¡¨ç¤ºæŠ•ç¨¿</div>
            </div>
          </div>
        </div>

        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ -->
        <div class="dashboard-widgets">
          <div class="widget recent-articles-widget">
            <div class="widget-header">
              <h2><i class="fas fa-newspaper"></i> æœ€è¿‘ã®è¨˜äº‹</h2>
              <div class="widget-header-actions">
                <button class="btn-icon" data-action="refresh-recent-articles" title="æ›´æ–°">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            <div class="widget-content">
              <div id="recent-articles">
                <div class="loading-state">
                  <i class="fas fa-spinner fa-spin"></i>
                  è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...
                </div>
              </div>
            </div>
          </div>

          <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
          <div class="widget quick-actions">
            <div class="widget-header">
              <h2><i class="fas fa-bolt"></i> ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
            </div>
            <div class="widget-content">
              <div class="action-buttons-grid">
                <!-- æ–°è¦è¨˜äº‹ä½œæˆ -->
                <button class="action-btn compact success" data-action="new-news-article">
                  <div class="action-icon">
                    <i class="fas fa-plus"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">æ–°è¦è¨˜äº‹ä½œæˆ</span>
                    <span class="action-desc">æ–°ã—ã„ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã‚’ä½œæˆ</span>
                  </div>
                </button>

                <!-- ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ -->
                <button class="action-btn compact info" data-action="export-data">
                  <div class="action-icon">
                    <i class="fas fa-download"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span>
                    <span class="action-desc">è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
                  </div>
                </button>

                <!-- ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³æ›´æ–° -->
                <button class="action-btn compact warning" data-action="update-lesson-status">
                  <div class="action-icon">
                    <i class="fas fa-calendar-check"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³</span>
                    <span class="action-desc">ç·´ç¿’çŠ¶æ³ã‚’æ›´æ–°</span>
                  </div>
                </button>

                <!-- è¨­å®šãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ -->
                <button class="action-btn compact secondary" data-action="switch-admin-tab" data-tab="settings">
                  <div class="action-icon">
                    <i class="fas fa-cog"></i>
                  </div>
                  <div class="action-content">
                    <span class="action-title">ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</span>
                    <span class="action-desc">ç®¡ç†ç”»é¢ã®è¨­å®š</span>
                  </div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- è¨˜äº‹ç®¡ç†ã‚¿ãƒ– -->
      <div class="admin-section" id="news-management">
        <div class="section-header">
          <h1><i class="fas fa-newspaper"></i> è¨˜äº‹ç®¡ç†</h1>
        </div>
        
        <!-- è¨˜äº‹ç®¡ç†ç”¨ã®ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-news-tab" data-tab="editor">
            <i class="fas fa-edit"></i>
            æ–°è¦è¨˜äº‹ä½œæˆ
          </div>
          <div class="sub-nav-item" data-action="switch-news-tab" data-tab="list">
            <i class="fas fa-list"></i>
            è¨˜äº‹ä¸€è¦§
          </div>
        </div>
        
        <!-- ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚¿ãƒ– -->
        <div id="news-editor-tab" class="news-tab-content active">
          <div class="editor-panel">
            <div class="panel-header">
              <h2><i class="fas fa-edit"></i> <span id="editor-title">æ–°è¦è¨˜äº‹ä½œæˆ</span></h2>
              <div class="panel-actions">
                <button class="btn btn-outline" data-action="clear-news-editor">
                  ã‚¯ãƒªã‚¢
                </button>
                <button class="btn btn-secondary" data-action="preview-news">
                  <i class="fas fa-eye"></i>
                  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
                </button>
                <button class="btn btn-primary" data-action="save-news">
                  <i class="fas fa-save"></i>
                  ä¿å­˜
                </button>
                <button class="btn btn-success" data-action="publish-news">
                  <i class="fas fa-globe"></i>
                  å…¬é–‹
                </button>
              </div>
            </div>
            
            <form class="editor-form">
              <input type="hidden" id="news-id">
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-title">
                    ã‚¿ã‚¤ãƒˆãƒ« <span class="required">*</span>
                  </label>
                  <input type="text" id="news-title" class="form-input" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" required>
                </div>
                <div class="form-group">
                  <label for="news-category">
                    ã‚«ãƒ†ã‚´ãƒªãƒ¼
                  </label>
                  <select id="news-category" class="form-select">
                    <option value="announcement">ãŠçŸ¥ã‚‰ã›</option>
                    <option value="event">ä½“é¨“ä¼š</option>
                    <option value="media">ãƒ¡ãƒ‡ã‚£ã‚¢</option>
                    <option value="important">é‡è¦</option>
                  </select>
                </div>
              </div>
              
              <div class="form-grid">
                <div class="form-group">
                  <label for="news-date">
                    å…¬é–‹æ—¥
                  </label>
                  <input type="date" id="news-date" class="form-input">
                </div>
                <div class="form-group">
                  <label for="news-status">
                    ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
                  </label>
                  <select id="news-status" class="form-select">
                    <option value="draft">ä¸‹æ›¸ã</option>
                    <option value="published">å…¬é–‹</option>
                  </select>
                </div>
              </div>
              
              <div class="form-group">
                <label for="news-summary">
                  æ¦‚è¦
                </label>
                <textarea id="news-summary" class="form-textarea" rows="3" placeholder="è¨˜äº‹ã®æ¦‚è¦ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆè¨˜äº‹ä¸€è¦§ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰"></textarea>
              </div>
              
              <div class="form-group">
                <label for="news-content">
                  æœ¬æ–‡ <span class="required">*</span>
                </label>
                <div class="editor-toolbar">
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="**" data-end="**" title="å¤ªå­—">
                    <strong>B</strong>
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="## " data-end="" title="è¦‹å‡ºã—">
                    H2
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="- " data-end="" title="ãƒªã‚¹ãƒˆ">
                    List
                  </button>
                  <button type="button" class="toolbar-btn" data-action="insert-markdown" data-start="[" data-end="](URL)" title="ãƒªãƒ³ã‚¯">
                    Link
                  </button>
                  <div class="toolbar-separator"></div>
                  <button type="button" class="toolbar-btn help-btn" data-action="show-writing-guide" title="è¨˜äº‹ä½œæˆã‚¬ã‚¤ãƒ‰">
                    <i class="fas fa-question-circle"></i>
                    ã‚¬ã‚¤ãƒ‰
                  </button>
                </div>
                <textarea id="news-content" class="form-textarea editor-content" placeholder="è¨˜äº‹ã®æœ¬æ–‡ã‚’Markdownå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„" required></textarea>
                <div class="form-help">
                  <small>Markdownè¨˜æ³•: **å¤ªå­—**ã€## è¦‹å‡ºã—ã€- ãƒªã‚¹ãƒˆã€[ãƒªãƒ³ã‚¯](URL) | <a href="#" data-action="show-writing-guide" class="help-link">ğŸ“– è©³ç´°ãªè¨˜äº‹ä½œæˆã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹</a></small>
                </div>
              </div>
              
              <div class="form-group">
                <label>
                  <input type="checkbox" id="news-featured"> æ³¨ç›®è¨˜äº‹ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹
                </label>
              </div>
            </form>
          </div>
        </div>
        
        <!-- è¨˜äº‹ä¸€è¦§ã‚¿ãƒ– -->
        <div id="news-list-tab" class="news-tab-content">
          <div class="list-panel full-width">
            <div class="panel-header">
              <h2><i class="fas fa-list"></i> è¨˜äº‹ä¸€è¦§</h2>
              <div class="panel-filters">
                <select id="news-filter" class="form-select" data-action="filter-news-list" data-target="news-filter">
                  <option value="all">ã™ã¹ã¦</option>
                  <option value="published">å…¬é–‹ä¸­</option>
                  <option value="draft">ä¸‹æ›¸ã</option>
                </select>
                <button class="btn btn-outline" data-action="refresh-news-list">
                  æ›´æ–°
                </button>
              </div>
            </div>
            <div id="news-list" class="list-content">
              <!-- è¨˜äº‹ä¸€è¦§ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
              <div class="loading-state">
                è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ã‚¿ãƒ– -->
      <div class="admin-section" id="lesson-status">
        <div class="section-header">
          <h1><i class="fas fa-calendar-check"></i> ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ç®¡ç†</h1>
        </div>

        <!-- ç¾åœ¨ã®çŠ¶æ³è¡¨ç¤º -->
        <div class="current-status-card">
          <div class="status-header">
            <h3><i class="fas fa-info-circle"></i> ç¾åœ¨ã®çŠ¶æ³</h3>
            <span class="status-date" id="current-status-date">ä»Šæ—¥</span>
          </div>
          <div class="status-display" id="current-status-display">
            <div class="status-indicator">
              <i class="fas fa-check-circle status-icon"></i>
              <span class="status-text">é€šå¸¸é–‹å‚¬</span>
            </div>
            <div class="status-updated">
              æœ€çµ‚æ›´æ–°: <span id="last-updated">-</span>
            </div>
          </div>
        </div>

        <!-- è¨­å®šãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="lesson-form-container">
          <div class="form-header">
            <h3><i class="fas fa-edit"></i> ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ã‚’è¨­å®š</h3>
            <div class="form-controls">
              <input type="date" id="lesson-date" class="date-input">
              <button class="btn btn-outline" data-action="load-lesson-status" id="load-btn">
                <i class="fas fa-download"></i> èª­ã¿è¾¼ã¿
              </button>
            </div>
          </div>

          <form class="lesson-form" id="lesson-form">
            <!-- å…¨ä½“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
            <div class="form-section">
              <label class="section-label">
                <i class="fas fa-bullhorn"></i>
                å…¨ä½“é–‹å‚¬ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
              </label>
              <div class="status-options">
                <label class="status-option">
                  <input type="radio" name="global-status" value="scheduled" checked>
                  <div class="option-card scheduled">
                    <i class="fas fa-check-circle"></i>
                    <span>é€šå¸¸é–‹å‚¬</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="cancelled">
                  <div class="option-card cancelled">
                    <i class="fas fa-times-circle"></i>
                    <span>ä¸­æ­¢</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="indoor">
                  <div class="option-card indoor">
                    <i class="fas fa-home"></i>
                    <span>å®¤å†…é–‹å‚¬</span>
                  </div>
                </label>
                <label class="status-option">
                  <input type="radio" name="global-status" value="postponed">
                  <div class="option-card postponed">
                    <i class="fas fa-clock"></i>
                    <span>å»¶æœŸ</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- å…¨ä½“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div class="form-section">
              <label for="global-message" class="section-label">
                <i class="fas fa-comment"></i>
                å…¨ä½“å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä»»æ„ï¼‰
              </label>
              <textarea id="global-message" placeholder="ä¿è­·è€…å‘ã‘ã®è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„" rows="3"></textarea>
            </div>

            <!-- ã‚³ãƒ¼ã‚¹åˆ¥è¨­å®š -->
            <div class="form-section">
              <label class="section-label">
                <i class="fas fa-users"></i>
                ã‚³ãƒ¼ã‚¹åˆ¥è¨­å®š
              </label>
              
              <div class="course-settings">
                <!-- ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚³ãƒ¼ã‚¹ -->
                <div class="course-card">
                  <div class="course-header">
                    <h4>ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚³ãƒ¼ã‚¹</h4>
                    <span class="course-time">17:00 - 17:50</span>
                  </div>
                  <div class="course-options">
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="scheduled" checked>
                      <span class="option-text scheduled">
                        <i class="fas fa-check-circle"></i>
                        é€šå¸¸é–‹å‚¬
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="cancelled">
                      <span class="option-text cancelled">
                        <i class="fas fa-times-circle"></i>
                        ä¸­æ­¢
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="indoor">
                      <span class="option-text indoor">
                        <i class="fas fa-home"></i>
                        å®¤å†…é–‹å‚¬
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="basic-status" value="postponed">
                      <span class="option-text postponed">
                        <i class="fas fa-clock"></i>
                        å»¶æœŸ
                      </span>
                    </label>
                  </div>
                </div>

                <!-- ã‚¢ãƒ‰ãƒãƒ³ã‚¹ã‚³ãƒ¼ã‚¹ -->
                <div class="course-card">
                  <div class="course-header">
                    <h4>ã‚¢ãƒ‰ãƒãƒ³ã‚¹ã‚³ãƒ¼ã‚¹</h4>
                    <span class="course-time">18:00 - 18:50</span>
                  </div>
                  <div class="course-options">
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="scheduled" checked>
                      <span class="option-text scheduled">
                        <i class="fas fa-check-circle"></i>
                        é€šå¸¸é–‹å‚¬
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="cancelled">
                      <span class="option-text cancelled">
                        <i class="fas fa-times-circle"></i>
                        ä¸­æ­¢
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="indoor">
                      <span class="option-text indoor">
                        <i class="fas fa-home"></i>
                        å®¤å†…é–‹å‚¬
                      </span>
                    </label>
                    <label class="course-option">
                      <input type="radio" name="advance-status" value="postponed">
                      <span class="option-text postponed">
                        <i class="fas fa-clock"></i>
                        å»¶æœŸ
                      </span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
            <div class="form-actions">
              <button type="button" class="btn btn-outline" data-action="preview-lesson-status">
                <i class="fas fa-eye"></i> ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
              </button>
              <button type="button" class="btn btn-secondary" data-action="save-draft-lesson-status">
                <i class="fas fa-save"></i> ä¸‹æ›¸ãä¿å­˜
              </button>
              <button type="button" class="btn btn-primary" data-action="update-lesson-status">
                <i class="fas fa-upload"></i> ä¿å­˜ã—ã¦å…¬é–‹
              </button>
            </div>
          </form>
        </div>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div class="preview-container preview-hidden" id="preview-container">
          <div class="preview-header">
            <h3><i class="fas fa-eye"></i> ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
            <button class="btn btn-sm" onclick="this.closest('.preview-container').classList.add('preview-hidden'); this.closest('.preview-container').classList.remove('preview-visible');">
              <i class="fas fa-times"></i> é–‰ã˜ã‚‹
            </button>
          </div>
          <div class="preview-content" id="preview-content">
            <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹ -->
          </div>
        </div>
      </div>

      <!-- Instagramç®¡ç†ã‚¿ãƒ– -->
      <div class="admin-section" id="instagram-management">
        <div class="section-header">
          <h1><i class="fab fa-instagram"></i> Instagramç®¡ç†</h1>
        </div>
        
        <!-- Instagramç®¡ç†ç”¨ã®ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="sub-nav">
          <div class="sub-nav-item active" data-action="switch-instagram-tab" data-tab="posts">
            <i class="fas fa-images"></i>
            æŠ•ç¨¿ç®¡ç†
          </div>
          <div class="sub-nav-item" data-action="switch-instagram-tab" data-tab="settings">
            <i class="fas fa-cog"></i>
            Instagramè¨­å®š
          </div>
        </div>
        
        <!-- æŠ•ç¨¿ç®¡ç†ã‚¿ãƒ– -->
        <div id="instagram-posts-tab" class="instagram-tab-content active">
          <div class="instagram-simple-layout">
            <!-- æŠ•ç¨¿è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  -->
            <div class="instagram-add-form">
              <div class="form-header">
                <h2><i class="fab fa-instagram"></i> InstagramæŠ•ç¨¿ã‚’è¿½åŠ </h2>
                <p>InstagramæŠ•ç¨¿ã®åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ã€è¡¨ç¤ºè¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„</p>
              </div>
              
              <form class="simple-form" id="instagram-post-form">
                <input type="hidden" id="instagram-post-id">
                
                <div class="embed-input-group">
                  <textarea id="instagram-embed-code" 
                           class="embed-textarea" 
                           placeholder="" 
                           rows="8"
                           required></textarea>
                  <div class="embed-hint">
                    <i class="fas fa-info-circle"></i>
                    InstagramæŠ•ç¨¿ãƒšãƒ¼ã‚¸ã§ã€ŒåŸ‹ã‚è¾¼ã¿ã€ã‚’é¸æŠã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ä¸Šè¨˜ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„
                  </div>
                  <button type="button" class="add-btn" data-action="save-instagram-post">
                    <i class="fas fa-plus"></i>
                    è¿½åŠ 
                  </button>
                </div>
                
                <div class="settings-row">
                  <label class="toggle-switch">
                    <input type="checkbox" id="instagram-status" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">è¡¨ç¤ºã™ã‚‹</span>
                  </label>
                  
                  <label class="featured-checkbox">
                    <input type="checkbox" id="instagram-featured">
                    <span class="checkmark"></span>
                    <span class="featured-label">
                      <i class="fas fa-star"></i>
                      æ³¨ç›®æŠ•ç¨¿
                    </span>
                  </label>
                </div>
              </form>
            </div>

            <!-- æŠ•ç¨¿ä¸€è¦§ -->
            <div class="instagram-posts-container">
              <div class="posts-header">
                <h3><i class="fas fa-images"></i> ç™»éŒ²æ¸ˆã¿æŠ•ç¨¿</h3>
                <div class="posts-actions">
                  <select id="instagram-filter" class="filter-select" data-action="filter-instagram-list">
                    <option value="all">ã™ã¹ã¦</option>
                    <option value="active">è¡¨ç¤ºä¸­</option>
                    <option value="inactive">éè¡¨ç¤º</option>
                    <option value="featured">æ³¨ç›®æŠ•ç¨¿</option>
                  </select>
                </div>
              </div>
              
              <div id="instagram-posts-list" class="posts-grid">
                <div class="loading-state">
                  <i class="fas fa-spinner fa-spin"></i>
                  InstagramæŠ•ç¨¿ã‚’èª­ã¿è¾¼ã¿ä¸­...
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Instagramè¨­å®šã‚¿ãƒ– -->
        <div id="instagram-settings-tab" class="instagram-tab-content">
          <div class="instagram-simple-layout">
            
            <!-- çµ±è¨ˆæƒ…å ± -->
            <div class="stats-overview">
              <h2><i class="fas fa-chart-line"></i> InstagramæŠ•ç¨¿çµ±è¨ˆ</h2>
              <div class="stats-cards" id="instagram-stats">
                <div class="stat-card">
                  <div class="stat-icon total">
                    <i class="fab fa-instagram"></i>
                  </div>
                  <div class="stat-info">
                    <div class="stat-number" id="total-posts">0</div>
                    <div class="stat-label">ç·æŠ•ç¨¿æ•°</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon active">
                    <i class="fas fa-eye"></i>
                  </div>
                  <div class="stat-info">
                    <div class="stat-number" id="active-posts">0</div>
                    <div class="stat-label">è¡¨ç¤ºä¸­</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon featured">
                    <i class="fas fa-star"></i>
                  </div>
                  <div class="stat-info">
                    <div class="stat-number" id="featured-posts">0</div>
                    <div class="stat-label">æ³¨ç›®æŠ•ç¨¿</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- è¡¨ç¤ºè¨­å®š -->
            <div class="display-settings">
              <h3><i class="fas fa-cog"></i> è¡¨ç¤ºè¨­å®š</h3>
              <form class="settings-form" id="instagram-settings-form">
                <div class="setting-row">
                  <label class="setting-label">æœ€å¤§è¡¨ç¤ºä»¶æ•°</label>
                  <select id="max-posts-display" class="setting-select">
                    <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
                  </select>
                </div>

                <div class="setting-row">
                  <label class="setting-label">æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã</label>
                  <label class="toggle-switch">
                    <input type="checkbox" id="open-new-tab" checked>
                    <span class="toggle-slider"></span>
                  </label>
                </div>

                <button type="button" class="save-settings-btn" data-action="save-instagram-settings">
                  <i class="fas fa-save"></i>
                  è¨­å®šã‚’ä¿å­˜
                </button>
              </form>
            </div>

          </div>
        </div>
      </div>

      <!-- è¨­å®šã‚¿ãƒ– -->
      <div class="admin-section" id="settings">
        <div class="section-header">
          <h1><i class="fas fa-cog"></i> è¨­å®š</h1>
        </div>
        
        <div class="settings-panel">
          <div class="setting-group">
            <h3><i class="fas fa-database"></i> ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
            <p>è¨˜äº‹ã€InstagramæŠ•ç¨¿ã€ãƒ¬ãƒƒã‚¹ãƒ³çŠ¶æ³ãƒ‡ãƒ¼ã‚¿ã®çµ±åˆç®¡ç†ã¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</p>
            <div class="setting-actions">
              <button class="btn btn-outline" data-action="export-data">
                <i class="fas fa-download"></i> å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
              </button>
              <button class="btn btn-outline" data-action="clear-all-data">
                <i class="fas fa-trash"></i> å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
              </button>
            </div>
            <small class="setting-note">
              <i class="fas fa-info-circle"></i>
              ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãŒæ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¼·åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚
            </small>
          </div>
          
          <div class="setting-group">
            <h3><i class="fas fa-link"></i> ã‚µã‚¤ãƒˆé€£æº</h3>
            <p>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µã‚¤ãƒˆã¨ã®é€£æºçŠ¶æ³</p>
            <div class="setting-actions">
              <button class="btn btn-primary" data-action="test-site-connection">
                <i class="fas fa-link"></i> é€£æºãƒ†ã‚¹ãƒˆ
              </button>
              <div id="site-connection-test-results" class="test-results"></div>
              <button class="btn btn-secondary" data-action="open-external" data-url="news.html">
                <i class="fas fa-external-link-alt"></i> ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã‚’é–‹ã
              </button>
            </div>
          </div>
          
          <div class="setting-group">
            <h3><i class="fas fa-tools"></i> é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«</h3>
            <p>é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯éè¡¨ç¤ºï¼‰</p>
            <div class="setting-actions">
              <button class="btn btn-info" data-action="show-debug-info">
                <i class="fas fa-info-circle"></i> ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤º
              </button>
              <button class="btn btn-info" data-action="show-news-debug">
                <i class="fas fa-bug"></i> ãƒ‹ãƒ¥ãƒ¼ã‚¹é€£æºãƒ‡ãƒãƒƒã‚°
              </button>
              <button class="btn btn-warning" data-action="reset-local-storage">
                <i class="fas fa-redo"></i> LocalStorage ãƒªã‚»ãƒƒãƒˆ
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="modal" class="modal modal-hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title"></h3>
        <button class="modal-close" data-action="close-modal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
      </div>
    </div>
  </div>

  <!-- é€šçŸ¥ã‚¨ãƒªã‚¢ -->
  <div id="notification-container" class="notification-container">
    <!-- é€šçŸ¥ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
  </div>

  <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ– -->
  <script type="module">
            import { initAdminFeature } from '../js/features/admin/index.js';
    
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        console.log('ğŸš€ RBSç®¡ç†ç”»é¢åˆæœŸåŒ–é–‹å§‹');
        
        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ã‚’åˆæœŸè¡¨ç¤º
        const initializeDashboard = () => {
          document.querySelectorAll('.admin-section').forEach(section => {
            section.classList.remove('active');
          });
          document.querySelectorAll('.nav-item').forEach(navItem => {
            navItem.classList.remove('active');
          });
          
          const dashboardSection = document.getElementById('dashboard');
          const dashboardNav = document.querySelector('[data-tab="dashboard"]');
          
          if (dashboardSection) {
            dashboardSection.classList.add('active');
          }
          if (dashboardNav) {
            dashboardNav.classList.add('active');
          }
          
          localStorage.setItem('rbs_admin_tab', 'dashboard');
        };
        
        initializeDashboard();
        
        // çµ±ä¸€ã•ã‚ŒãŸç®¡ç†æ©Ÿèƒ½åˆæœŸåŒ–
        await initAdminFeature();
        
        console.log('âœ… RBSç®¡ç†ç”»é¢åˆæœŸåŒ–å®Œäº†');
        
      } catch (error) {
        console.error('âŒ ç®¡ç†ç”»é¢åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
        
        // ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¯ initAdminFeature å†…ã§å®Ÿè¡Œæ¸ˆã¿
        // ã“ã“ã§ã¯è¿½åŠ ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã®ã¿
        if (!window.location.pathname.includes('admin-login.html')) {
          const shouldRedirect = confirm(
            `ç®¡ç†ç”»é¢ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n\nã‚¨ãƒ©ãƒ¼: ${error.message}\n\nãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ`
          );
          if (shouldRedirect) {
            localStorage.removeItem('rbs_admin_auth');
            window.location.replace('admin-login.html?from=admin');
          }
        }
      }
    });
  </script>

  <!-- é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ãƒ‘ãƒ¼ -->
  <script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«é€šçŸ¥çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ 
    window.notificationHistory = new Map();
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«é€šçŸ¥ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼ˆé‡è¤‡é˜²æ­¢æ©Ÿèƒ½ä»˜ãï¼‰
    window.showNotification = function(type, message, duration = 4000, options = {}) {
      // é‡è¤‡ãƒã‚§ãƒƒã‚¯
      const notificationKey = `${type}:${message}`;
      const now = Date.now();
      
      if (window.notificationHistory.has(notificationKey)) {
        const lastTime = window.notificationHistory.get(notificationKey);
        if (now - lastTime < 3000) {
          console.debug('é‡è¤‡é€šçŸ¥ã‚’ã‚¹ã‚­ãƒƒãƒ—:', message);
          return;
        }
      }
      
      // é€šçŸ¥å±¥æ­´ã«è¨˜éŒ²
      window.notificationHistory.set(notificationKey, now);
      
      // æ—¢å­˜ã®åŒã˜é€šçŸ¥ã‚’å‰Šé™¤
      document.querySelectorAll('.global-notification').forEach(notification => {
        if (notification.textContent.includes(message)) {
          notification.remove();
        }
      });
      
      if (window.uiManagerService) {
        return window.uiManagerService.showNotification(type, message, duration, options);
      } else {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚·ãƒ³ãƒ—ãƒ«ãªé€šçŸ¥
        console.log(`${type.toUpperCase()}: ${message}`);
        
        // ç°¡æ˜“é€šçŸ¥è¦ç´ ã‚’ä½œæˆ
        const notification = document.createElement('div');
        notification.className = `global-notification ${type}`;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        setTimeout(() => {
          notification.classList.add('show');
        }, 10);
        
        // è‡ªå‹•å‰Šé™¤
        setTimeout(() => {
          notification.classList.remove('show');
          notification.classList.add('hide');
          setTimeout(() => {
            if (notification.parentNode) {
              notification.remove();
            }
          }, 300);
        }, duration);
      }
      
      // å±¥æ­´ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆ5åˆ†å¾Œï¼‰
      setTimeout(() => {
        window.notificationHistory.delete(notificationKey);
      }, 300000);
    };
    
    // ä¾¿åˆ©ãªãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    window.showSuccess = (message, duration, options) => 
      window.showNotification('success', message, duration, options);
    
    window.showError = (message, duration, options) => 
      window.showNotification('error', message, duration, options);
    
    window.showWarning = (message, duration, options) => 
      window.showNotification('warning', message, duration, options);
    
    window.showInfo = (message, duration, options) => 
      window.showNotification('info', message, duration, options);
    
    // ActionManager ã‚¢ã‚¯ã‚»ã‚¹ãƒ˜ãƒ«ãƒ‘ãƒ¼
    window.registerAction = function(actionName, handler) {
      if (window.app && window.app.actionManager) {
        window.app.actionManager.register(actionName, handler);
        console.log(`âœ… ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç™»éŒ²: ${actionName}`);
      } else {
        console.warn(`âš ï¸ ActionManagerãŒåˆ©ç”¨ã§ãã¾ã›ã‚“: ${actionName}`);
      }
    };
    
    // ãƒ‡ãƒãƒƒã‚°ç”¨: ç™»éŒ²æ¸ˆã¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§è¡¨ç¤º
    window.listActions = function() {
      if (window.app && window.app.actionManager) {
        console.log('ğŸ“‹ ç™»éŒ²æ¸ˆã¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:', Array.from(window.app.actionManager._actions.keys()));
      } else if (window.actionManager) {
        console.log('ğŸ“‹ ç™»éŒ²æ¸ˆã¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:', Array.from(window.actionManager._actions.keys()));
      } else {
        console.warn('âš ï¸ ActionManagerãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
      }
    };

    // ãƒ‡ãƒãƒƒã‚°ç”¨: ã‚¿ãƒ–æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
    window.testTabFunction = function(tabName = 'dashboard') {
      console.log(`ğŸ§ª ã‚¿ãƒ–æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹: ${tabName}`);
      
      if (window.adminActionService) {
        console.log('âœ… AdminActionServiceãŒåˆ©ç”¨å¯èƒ½');
        window.adminActionService.switchAdminTab(tabName);
      } else {
        console.error('âŒ AdminActionServiceãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
      }
    };

    // ãƒ‡ãƒãƒƒã‚°ç”¨: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
    window.testAction = function(actionName, params = {}) {
      console.log(`ğŸ§ª ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒ†ã‚¹ãƒˆ: ${actionName}`, params);
      
      if (window.actionManager) {
        const element = document.createElement('div');
        element.setAttribute('data-action', actionName);
        
        // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’dataå±æ€§ã¨ã—ã¦è¨­å®š
        Object.keys(params).forEach(key => {
          element.setAttribute(`data-${key}`, params[key]);
        });
        
        window.actionManager.handleAction(element, new Event('click'));
      } else {
        console.error('âŒ ActionManagerãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
      }
    };

    // ãƒ‡ãƒãƒƒã‚°ç”¨: DOMè¦ç´ ç¢ºèª
    window.checkTabElements = function() {
      console.log('ğŸ” ã‚¿ãƒ–é–¢é€£DOMè¦ç´ ç¢ºèª');
      
      const navItems = document.querySelectorAll('.nav-item[data-tab]');
      const sections = document.querySelectorAll('.admin-section');
      
      console.log('ğŸ“‹ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ :', Array.from(navItems).map(item => ({
        tab: item.dataset.tab,
        action: item.dataset.action,
        active: item.classList.contains('active')
      })));
      
      console.log('ğŸ“‹ ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ :', Array.from(sections).map(section => ({
        id: section.id,
        active: section.classList.contains('active')
      })));
    };

    // çµ±è¨ˆæƒ…å ±æ›´æ–°æ©Ÿèƒ½
    window.updateDashboardStats = function() {
      try {
        // config.jsã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹local storageã‚­ãƒ¼ã‚’ä½¿ç”¨
        const articlesKey = 'rbs_articles';
        const instagramKey = 'rbs_instagram_posts';
        
        // è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
        let articles = [];
        let publishedCount = 0;
        let draftCount = 0;
        
        try {
          const articlesData = localStorage.getItem(articlesKey);
          if (articlesData) {
            articles = JSON.parse(articlesData);
            if (Array.isArray(articles)) {
              publishedCount = articles.filter(article => article.status === 'published').length;
              draftCount = articles.filter(article => article.status === 'draft').length;
            }
          }
        } catch (error) {
          console.warn('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
        
        // InstagramæŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
        let instagramPosts = [];
        let instagramVisibleCount = 0;
        let instagramHiddenCount = 0;
        
        try {
          const instagramData = localStorage.getItem(instagramKey);
          if (instagramData) {
            instagramPosts = JSON.parse(instagramData);
            if (Array.isArray(instagramPosts)) {
              instagramVisibleCount = instagramPosts.filter(post => post.status === 'active').length;
              instagramHiddenCount = instagramPosts.filter(post => post.status === 'inactive').length;
            }
          }
        } catch (error) {
          console.warn('InstagramæŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        }
        
        // çµ±è¨ˆã‚«ãƒ¼ãƒ‰ã®æ›´æ–°
        const updateStatCard = (id, value) => {
          const element = document.getElementById(id);
          if (element) {
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§æ•°å€¤ã‚’æ›´æ–°
            const currentValue = parseInt(element.textContent) || 0;
            if (currentValue !== value) {
              element.style.transform = 'scale(1.1)';
              element.style.transition = 'transform 0.2s ease';
              setTimeout(() => {
                element.textContent = value;
                element.style.transform = 'scale(1)';
              }, 100);
            } else {
              element.textContent = value;
            }
          }
        };
        
        // å„çµ±è¨ˆã‚«ãƒ¼ãƒ‰ã‚’æ›´æ–°
        updateStatCard('stat-published', publishedCount);
        updateStatCard('stat-drafts', draftCount);
        updateStatCard('stat-instagram-visible', instagramVisibleCount);
        updateStatCard('stat-instagram-hidden', instagramHiddenCount);
        
        console.log('ğŸ“Š çµ±è¨ˆæƒ…å ±æ›´æ–°å®Œäº†:', {
          å…¬é–‹è¨˜äº‹: publishedCount,
          ä¸‹æ›¸ã: draftCount,
          Instagramè¡¨ç¤ºæŠ•ç¨¿: instagramVisibleCount,
          Instagraméè¡¨ç¤ºæŠ•ç¨¿: instagramHiddenCount
        });
        
      } catch (error) {
        console.error('çµ±è¨ˆæƒ…å ±æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
      }
    };
    
    // å®šæœŸçš„ãªçµ±è¨ˆæ›´æ–°ï¼ˆ5ç§’é–“éš”ï¼‰
    setInterval(window.updateDashboardStats, 5000);
    
    // åˆå›çµ±è¨ˆæ›´æ–°ï¼ˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ï¼‰
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(window.updateDashboardStats, 1000);
    });
    
    // storageå¤‰æ›´æ™‚ã®çµ±è¨ˆæ›´æ–°
    window.addEventListener('storage', function(e) {
      if (e.key === 'rbs_articles' || e.key === 'rbs_instagram_posts') {
        setTimeout(window.updateDashboardStats, 100);
      }
    });
    
    // æ‰‹å‹•æ›´æ–°æ©Ÿèƒ½
    window.refreshStats = window.updateDashboardStats;
  </script>

  <!-- InstagramåŸ‹ã‚è¾¼ã¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ2024å¹´æœ€é©åŒ–ï¼‰ -->
  <script>
    // InstagramåŸ‹ã‚è¾¼ã¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é«˜åº¦ãªèª­ã¿è¾¼ã¿ç®¡ç†
    (function() {
      let instagramScriptLoaded = false;
      let instagramScriptLoading = false;
      let loadAttempts = 0;
      const maxAttempts = 3;
      
      function loadInstagramScript() {
        if (instagramScriptLoaded || instagramScriptLoading) return;
        
        instagramScriptLoading = true;
        loadAttempts++;
        
        const script = document.createElement('script');
        script.async = true;
        script.src = '//www.instagram.com/embed.js';
        
        script.onload = function() {
          instagramScriptLoaded = true;
          instagramScriptLoading = false;
          console.log('âœ… InstagramåŸ‹ã‚è¾¼ã¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿å®Œäº†');
          
          // æ—¢å­˜ã®åŸ‹ã‚è¾¼ã¿ã‚’å‡¦ç†
          if (window.instgrm && window.instgrm.Embeds) {
            setTimeout(() => {
              window.instgrm.Embeds.process();
            }, 100);
          }
        };
        
        script.onerror = function() {
          instagramScriptLoading = false;
          console.warn('âš ï¸ InstagramåŸ‹ã‚è¾¼ã¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿å¤±æ•—');
          
          // ãƒªãƒˆãƒ©ã‚¤
          if (loadAttempts < maxAttempts) {
            setTimeout(loadInstagramScript, 2000 * loadAttempts);
          }
        };
        
        // æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‰Šé™¤ã—ã¦æ–°ã—ãè¿½åŠ 
        const existingScript = document.querySelector('script[src*="embed.js"]');
        if (existingScript) {
          existingScript.remove();
        }
        
        document.head.appendChild(script);
      }
      
      // åˆå›èª­ã¿è¾¼ã¿
      loadInstagramScript();
      
      // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã¨ã—ã¦å…¬é–‹
      window.reloadInstagramScript = loadInstagramScript;
      
      // DOMå¤‰æ›´ã‚’ç›£è¦–ã—ã¦InstagramåŸ‹ã‚è¾¼ã¿ã‚’è‡ªå‹•å‡¦ç†
      if (window.MutationObserver) {
        const observer = new MutationObserver(function(mutations) {
          let hasInstagramElements = false;
          
          mutations.forEach(function(mutation) {
            mutation.addedNodes.forEach(function(node) {
              if (node.nodeType === Node.ELEMENT_NODE) {
                if (node.querySelector && node.querySelector('.instagram-media, .instagram-embed-wrapper')) {
                  hasInstagramElements = true;
                }
              }
            });
          });
          
          if (hasInstagramElements && window.instgrm && window.instgrm.Embeds) {
            setTimeout(() => {
              window.instgrm.Embeds.process();
            }, 100);
          }
        });
        
        observer.observe(document.body, {
          childList: true,
          subtree: true
        });
      }
    })();
  </script>
</body>
</html>