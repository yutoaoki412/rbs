<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨˜äº‹ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ - RBSé™¸ä¸Šæ•™å®¤</title>
  <link rel="stylesheet" href="../css/admin-style.css">
</head>
<body>
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <div class="logo">RBSé™¸ä¸Šæ•™å®¤</div>
        <div class="breadcrumb">ç®¡ç†ç”»é¢ > è¨˜äº‹ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</div>
      </div>
      <div class="header-actions">
        <div class="save-status" id="save-status">æœªä¿å­˜</div> <!-- This will be managed by AdminEditor -->
        <!-- Replaced onclick with IDs for AdminEditor event listeners -->
        <button class="btn btn-warning" id="saveDraftBtn">
          ğŸ’¾ ä¸‹æ›¸ãä¿å­˜
        </button>
        <button class="btn btn-success" id="publishBtn">
          ğŸ“¤ å…¬é–‹
        </button>
        <!-- backBtn ID is used by AdminEditor for navigation check -->
        <a href="index.html" class="btn btn-secondary" id="backBtn">
          â† æˆ»ã‚‹
        </a>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="sidebar">
      <div class="sidebar-section">
        <!-- pageTitle ID might be used by AdminEditor if it exists -->
        <h3 class="sidebar-title" id="pageTitle">è¨˜äº‹æƒ…å ±</h3> 
        
        <div class="form-group">
          <label class="form-label" for="article-title">ã‚¿ã‚¤ãƒˆãƒ«</label>
          <!-- Changed ID to 'title' to match AdminEditor expectations, but 'article-title' is used in AdminEditor's getFormData -->
          <input type="text" id="article-title" class="form-input" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›">
        </div>

        <div class="form-group">
          <label class="form-label" for="article-date">å…¬é–‹æ—¥</label>
          <!-- Changed ID to 'date' -->
          <input type="date" id="article-date" class="form-input">
        </div>

        <div class="form-group">
          <label class="form-label" for="article-category">ã‚«ãƒ†ã‚´ãƒªãƒ¼</label>
          <!-- Changed ID to 'category' -->
          <select id="article-category" class="form-select">
            <option value="announcement">ãŠçŸ¥ã‚‰ã›</option>
            <option value="trial">ä½“é¨“ä¼š</option>
            <option value="media">ãƒ¡ãƒ‡ã‚£ã‚¢</option>
            <option value="important">é‡è¦</option>
          </select>
        </div>
        <!-- Optional categoryName field, AdminEditor can handle its absence -->
        <!-- <div class="form-group">
          <label class="form-label" for="categoryName">ã‚«ãƒ†ã‚´ãƒªãƒ¼åï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰</label>
          <input type="text" id="categoryName" class="form-input" readonly>
        </div> -->

        <div class="form-group">
          <label class="form-label" for="article-excerpt">æŠœç²‹</label>
          <!-- Changed ID to 'excerpt' -->
          <textarea id="article-excerpt" class="form-textarea" placeholder="è¨˜äº‹ã®æ¦‚è¦ã‚’å…¥åŠ›ï¼ˆ150æ–‡å­—ç¨‹åº¦ï¼‰"></textarea>
        </div>

        <div class="form-group">
          <div class="checkbox-group">
            <!-- Changed ID to 'featured' -->
            <input type="checkbox" id="article-featured">
            <label class="form-label" for="article-featured">æ³¨ç›®è¨˜äº‹ã«ã™ã‚‹</label>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
          <!-- These elements are updated by the inline script's updateStatusDisplay. -->
          <!-- AdminEditor might need its own way or these need to be standardized if AdminEditor takes over display. -->
          <div class="status-indicator" id="status-indicator">
            <span id="status-text">ä¸‹æ›¸ã</span>
          </div>
        </div>
      </div>

      <div class="sidebar-section">
        <h3 class="sidebar-title">Markdownãƒ˜ãƒ«ãƒ—</h3>
        <!-- Markdown Toolbar (optional, AdminEditor can initialize this if #markdownToolbar exists) -->
        <!-- <div id="markdownToolbar"></div> -->
        <div class="markdown-help">
          <h4>åŸºæœ¬çš„ãªè¨˜æ³•</h4>
          <p><code># è¦‹å‡ºã—1</code></p>
          <p><code>## è¦‹å‡ºã—2</code></p>
          <p><code>**å¤ªå­—**</code></p>
          <p><code>*æ–œä½“*</code></p>
          <p><code>[ãƒªãƒ³ã‚¯](URL)</code></p>
          <p><code>- ãƒªã‚¹ãƒˆé …ç›®</code></p>
          <p><code>> å¼•ç”¨</code></p>
          <p><code>`ã‚³ãƒ¼ãƒ‰`</code></p>
        </div>
      </div>
    </div>

    <div class="main-content">
      <div class="editor-tabs">
        <!-- Removed onclick, tab switching needs to be handled by AdminEditor or a separate utility script if not already -->
        <button class="tab-button active" id="editorTabBtn"> 
          ğŸ“ ç·¨é›†
        </button>
        <button class="tab-button" id="previewTabBtn">
          ğŸ‘ï¸ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        </button>
      </div>

      <div class="editor-container">
        <div class="editor-pane active" id="editor-pane">
          <!-- Changed ID to 'content' for AdminEditor, markdown-editor is also checked by AdminEditor -->
          <textarea 
            id="markdown-editor" 
            class="markdown-editor" 
            placeholder="ã“ã“ã«Markdownã§è¨˜äº‹ã‚’æ›¸ã„ã¦ãã ã•ã„...

# è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«

è¨˜äº‹ã®å†…å®¹ã‚’ã“ã“ã«æ›¸ãã¾ã™ã€‚

## è¦‹å‡ºã—2

æ®µè½ã®å†…å®¹...

### è¦‹å‡ºã—3

- ãƒªã‚¹ãƒˆé …ç›®1
- ãƒªã‚¹ãƒˆé …ç›®2

**å¤ªå­—ã®ãƒ†ã‚­ã‚¹ãƒˆ**ã‚„*æ–œä½“ã®ãƒ†ã‚­ã‚¹ãƒˆ*ã‚‚ä½¿ãˆã¾ã™ã€‚

> å¼•ç”¨æ–‡ã¯ã“ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

è©³ç´°ã¯[ãƒªãƒ³ã‚¯](https://example.com)ã‚’ã”è¦§ãã ã•ã„ã€‚"
          ></textarea>
        </div>

        <div class="editor-pane" id="preview-pane">
           <!-- preview-content is used by inline script, AdminEditor uses previewContainer -->
          <div class="preview-content" id="preview-content">
            <p>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Message container for AdminEditor -->
  <div id="messageContainer" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;"></div>

  <script src="../js/admin/admin-auth.js"></script>
  <script src="../js/admin/admin-manager.js"></script>
  <script src="../js/app/article-display.js"></script> <!-- markdown-parser.js was moved to js/app/article-display.js -->
  <!-- Include the external AdminEditor script -->
  <script src="../js/admin/admin-editor.js"></script> 
  
  <!-- Removed large inline script block. AdminEditor class from admin-editor.js will handle logic. -->
  <!-- Minimal inline script might be needed for tab switching if not handled by AdminEditor -->
  <script>
    // Tab switching logic (can be moved to AdminEditor or kept minimal here if AdminEditor doesn't handle it)
    // For now, assuming AdminEditor might not handle these specific tab buttons unless IDs match its setup.
    // Or, if AdminEditor is modified to handle these specific IDs.
    // The original inline script had switchTab function. This is a simplified version.
    const editorTabBtn = document.getElementById('editorTabBtn');
    const previewTabBtn = document.getElementById('previewTabBtn');
    const editorPane = document.getElementById('editor-pane');
    const previewPane = document.getElementById('preview-pane');
    const markdownEditor = document.getElementById('markdown-editor');
    const previewContent = document.getElementById('preview-content');
    const localMarkdownParser = new MarkdownParser(); // For this minimal tab logic only

    if (editorTabBtn && previewTabBtn && editorPane && previewPane && markdownEditor && previewContent) {
      editorTabBtn.addEventListener('click', () => {
        editorTabBtn.classList.add('active');
        previewTabBtn.classList.remove('active');
        editorPane.classList.add('active');
        previewPane.classList.remove('active');
      });

      previewTabBtn.addEventListener('click', () => {
        previewTabBtn.classList.add('active');
        editorTabBtn.classList.remove('active');
        previewPane.classList.add('active');
        editorPane.classList.remove('active');
        // Update preview when switching to preview tab
        const markdown = markdownEditor.value;
        previewContent.innerHTML = localMarkdownParser.parse(markdown);
      });
    }

    // The AdminEditor class in admin-editor.js should handle the core editor logic.
    // It has its own DOMContentLoaded listener to initialize.
    // The status display (status-indicator, status-text, save-status) also needs to be
    // managed by AdminEditor or through a common interface if it's to be kept.
    // The AdminEditor class currently does not manage these specific display elements from editor.html.
    // It uses its own showMessage for feedback.

    // Functions like updateStatusDisplay, updateSaveStatus, markAsUnsaved from the old inline script
    // will need to be integrated into AdminEditor or removed if AdminEditor provides alternatives.
    // For example, AdminEditor's this.hasUnsavedChanges and this.updateSaveButtonState() cover some of this.
  </script>
</body>
</html>